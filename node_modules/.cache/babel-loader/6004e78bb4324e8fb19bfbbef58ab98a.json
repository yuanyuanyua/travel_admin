{"remainingRequest":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\babel-loader\\lib\\index.js!D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\QQ下载文件\\BT\\travel_manage\\src\\components\\page\\OrderList.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\QQ下载文件\\BT\\travel_manage\\src\\components\\page\\OrderList.vue","mtime":1615364792747},{"path":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/es6.regexp.replace\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport api from \"../../utils/api\";\nexport default {\n  name: 'OrderList',\n  data: function data() {\n    return {\n      userInfo: {},\n      showRemark: false,\n      query: {\n        //supplierId: '',// 页面初始化时即赋值\n        orderId: '',\n        goodsName: '',\n        contactName: '',\n        state: '',\n        userName: '',\n        current: 1,\n        size: 6\n      },\n      show_state: '',\n      tableData: [// {\n        //     user_nickname: \"TY\",\n        //     adult_num: 1,\n        //     child_num: 1,\n        //     departure_time: \"2020-04-23\",\n        //     id: 1,\n        //     link_man: [\n        //         {   mobile: \"13476818230\",name: \"TY\"    }\n        //     ],\n        //     passenger:[\n        //         {   mobile: \"13476818230\",name: \"TY\"    }\n        //     ],\n        //     order_time: \"2020-05-23T01:52:39.000+0000\",\n        //     state: 3,\n        //     title: \"三亚春节热售 豪品0自费 印象丽江+洱海大邮轮+玉龙雪山\"\n        // }\n      ],\n      pageTotal: 0,\n      isLoading: false,\n      // categoryList: [],\n      // categoryIdMap: {},\n      //handleTitle: '',\n      //form: {},\n      searchType: '',\n      search_key_word: '',\n      showType: 'normalData',\n      //cityList: [],\n      stateList: ['待付款', '待接单', '待出行', '已完成', '退款申请', '取消退款申请']\n    };\n  },\n  created: function created() {\n    // this.pageInit();\n    //this.getTableData();\n    this.userInfo = JSON.parse(localStorage.getItem('userInfo')); //this.query.supplierId = this.userInfo.id\n\n    this.getOrderList(); //获取订单列表\n  },\n  methods: {\n    handleSub: function handleSub(row) {\n      var _this = this;\n\n      var state = row.state;\n\n      if (state == 1) {\n        this.$confirm('是否确认退款', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(function () {\n          _this.$message({\n            type: 'success',\n            message: '退款成功!'\n          });\n        }).catch(function () {\n          _this.$message({\n            type: 'info',\n            message: '已取消退款'\n          });\n        });\n      }\n\n      if (state == 2) this.showRemark = true;\n    },\n    initQuery: function initQuery() {\n      this.query.orderId = '';\n      this.query.goodsName = '';\n      this.query.contactName = '';\n      this.query.userName = '';\n      this.current = 1;\n      this.size = 4;\n    },\n    search: function search() {\n      this.initQuery();\n\n      if (this.searchType == '0') {\n        this.query.orderId = this.search_key_word;\n      } else if (this.searchType == '1') {\n        this.query.goodsName = this.search_key_word;\n      } else if (this.searchType == '2') {\n        this.query.contactName = this.search_key_word;\n      } else if (this.searchType == '3') {\n        this.query.userName = this.search_key_word;\n      }\n\n      this.isLoading = true;\n      this.getOrderList();\n    },\n    // // 正确显示订单状态\n    // handleTags(data) {\n    //     return this.stateList[data.state - 1];\n    // },\n    click: function click() {},\n    handleSensitive: function handleSensitive(number) {\n      return number.replace(number.substring(3, 7), '****');\n    },\n    handleTags: function handleTags(data) {\n      return this.stateList[data.state - 1];\n    },\n    handleRefund: function handleRefund(data) {\n      var _this2 = this;\n\n      if (data.state !== 6) {\n        return;\n      }\n\n      this.$confirm('是否接受退款申请', '提示', {\n        distinguishCancelAndClose: true,\n        type: 'warning',\n        confirmButtonText: '接受',\n        cancelButtonText: '拒绝'\n      }).then(function () {}).catch(function (action) {\n        _this2.$message({\n          type: 'info',\n          message: action === 'cancel' ? '拒绝退款' : '关闭页面'\n        });\n      });\n    },\n    // 获取改变的状态选择值\n    getShowState: function getShowState(e) {\n      this.query.state = e;\n      this.isLoading = true;\n      this.getOrderList();\n    },\n    // getShowState(e) {\n    //     if (parseInt(e) === 0) {\n    //         this.isLoading = true;\n    //         this.getTableData();\n    //         this.isLoading = false;\n    //     } else {\n    //         api.searchSpecifiedOrder({\n    //             attrName: 'state',\n    //             attrValue: e,\n    //             pageNum: this.query.pageIndex,\n    //             pageSize: this.query.pageSize\n    //         }).then(res => {\n    //             this.tableData = res.data.orders;\n    //             this.pageTotal = res.data.total;\n    //             this.isLoading = false;\n    //         });\n    //     }\n    // },\n    // 获取订单列表\n    getOrderList: function getOrderList() {\n      var _this3 = this;\n\n      this.api.getOrderList(this.query).then(function (res) {\n        console.log(res);\n\n        if (res.code == \"200\") {\n          _this3.isLoading = false;\n\n          _this3.$message.success(\"成功获取订单列表\");\n\n          _this3.tableData = res.data.data;\n          _this3.pageTotal = res.data.total; // if(this.tableData != null) {\n          //     this.tableData.forEach(item => {\n          //         this.api.getPassenger({orderId: item.id}).then(response => {\n          //             if(response.code==\"200\"){\n          //                 item.passengerList = response.data\n          //             }else {\n          //                 this.$message.error(\"获取旅客信息列表失败\")\n          //             }\n          //         })\n          //     })\n          // }\n        } else {\n          _this3.$message.error(\"获取订单列表失败\");\n        }\n      });\n    },\n    // 分页导航点击事件\n    handlePageChange: function handlePageChange(val, e) {\n      this.$set(this.query, 'current', val);\n      this.getOrderList();\n    },\n    // getTableData() {\n    //     this.api.getTableData().then(res => {\n    //     console.log(res)\n    //     if(res.code==\"200\") {\n    //         this.$message.success(\"成功获取订单信息\")\n    //         this.tableData = res.data\n    //     }else{\n    //         this.$message.error(res.message)\n    //     }\n    // })\n    //     // this.isLoading = true;\n    //     // var that = this;\n    //     // api.getOrderList({\n    //     //     pageNum: that.query.pageIndex,\n    //     //     pageSize: that.query.pageSize\n    //     // }).then(res0 => {\n    //     //     this.tableData = res0.data.orders;\n    //     //     this.pageTotal = res0.data.total;\n    //     //     this.isLoading = false;\n    //     //     console.log(this.form);\n    //     // }).catch(err => {\n    //     //     console.log(err);\n    //     // });\n    // },\n    handleSelection: function handleSelection(e) {\n      console.log(e);\n    },\n    // handlePageChange(val, e) {\n    //     this.$set(this.query, 'pageIndex', val);\n    //     if (this.showType === 'normalData') {\n    //         this.getOrderList();\n    //     } else {\n    //         this.getSearchResult(e, val);\n    //     }\n    // },\n    getSearchType: function getSearchType(e) {},\n    getSearchResult: function getSearchResult(e) {\n      var _this4 = this;\n\n      var pageNum = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.query.pageIndex;\n      this.isLoading = true;\n      var list = ['user_nickname', 'title', 'order_time', 'deal_time', 'linkMan', 'passenger'];\n      var that = this;\n      this.query.pageIndex = 1;\n\n      if (this.search_key_word) {\n        this.showType = 'searching';\n        api.searchSpecifiedOrder({\n          attrName: list[this.searchType] || 'user_nickname',\n          attrValue: this.search_key_word,\n          pageNum: pageNum,\n          pageSize: that.query.pageSize\n        }).then(function (res) {\n          _this4.tableData = res.data.orders;\n          _this4.pageTotal = res.data.total;\n          _this4.isLoading = false;\n        });\n      } else {\n        this.showType = 'normal';\n        this.$message.error('请输入搜索内容');\n        this.query.pageIndex = 1;\n        this.getOrderList();\n        this.isLoading = false;\n      }\n\n      console.log(this.showType);\n    },\n    //数组去重\n    uniArr: function uniArr(arr) {\n      var obj = {};\n      var new_arr = arr.reduce(function (prev, element) {\n        if (!prev.find(function (el) {\n          return el.category_con_id == element.category_con_id;\n        })) {\n          prev.push(element);\n        }\n\n        return prev;\n      }, []);\n      return new_arr;\n    } //初始化城市列表\n    // initCity(cityList) {\n    //     var cl = [];\n    //     cityList.forEach(c => {\n    //         var t = {\n    //             value: c.id,\n    //             label: c.city\n    //         };\n    //         cl.push(t);\n    //     });\n    //     return cl;\n    // },\n    // pageInit() {\n    //     api.getAllCities().then(res => {\n    //         if (res.code === 200) {\n    //             this.cityList = this.initCity(res.data);\n    //             localStorage.setItem('cityList', JSON.stringify(this.cityList));\n    //         }\n    //     }).catch(err => {\n    //         console.log(err);\n    //     }).then(res => {\n    //         this.getTableData();\n    //     });\n    // }\n\n  }\n};",{"version":3,"sources":["OrderList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+JA,OAAA,GAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,WADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,QAAA,EAAA,EADA;AAEA,MAAA,UAAA,EAAA,KAFA;AAGA,MAAA,KAAA,EAAA;AACA;AACA,QAAA,OAAA,EAAA,EAFA;AAGA,QAAA,SAAA,EAAA,EAHA;AAIA,QAAA,WAAA,EAAA,EAJA;AAKA,QAAA,KAAA,EAAA,EALA;AAMA,QAAA,QAAA,EAAA,EANA;AAOA,QAAA,OAAA,EAAA,CAPA;AAQA,QAAA,IAAA,EAAA;AARA,OAHA;AAaA,MAAA,UAAA,EAAA,EAbA;AAcA,MAAA,SAAA,EAAA,CACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAhBA,OAdA;AAgCA,MAAA,SAAA,EAAA,CAhCA;AAiCA,MAAA,SAAA,EAAA,KAjCA;AAkCA;AACA;AACA;AACA;AACA,MAAA,UAAA,EAAA,EAtCA;AAuCA,MAAA,eAAA,EAAA,EAvCA;AAwCA,MAAA,QAAA,EAAA,YAxCA;AAyCA;AACA,MAAA,SAAA,EAAA,CAAA,KAAA,EAAA,KAAA,EAAA,KAAA,EAAA,KAAA,EAAA,MAAA,EAAA,QAAA;AA1CA,KAAA;AA4CA,GA/CA;AAgDA,EAAA,OAhDA,qBAgDA;AACA;AACA;AACA,SAAA,QAAA,GAAA,IAAA,CAAA,KAAA,CAAA,YAAA,CAAA,OAAA,CAAA,UAAA,CAAA,CAAA,CAHA,CAIA;;AACA,SAAA,YAAA,GALA,CAKA;AACA,GAtDA;AAuDA,EAAA,OAAA,EAAA;AACA,IAAA,SADA,qBACA,GADA,EACA;AAAA;;AACA,UAAA,KAAA,GAAA,GAAA,CAAA,KAAA;;AACA,UAAA,KAAA,IAAA,CAAA,EAAA;AACA,aAAA,QAAA,CAAA,QAAA,EAAA,IAAA,EAAA;AACA,UAAA,iBAAA,EAAA,IADA;AAEA,UAAA,gBAAA,EAAA,IAFA;AAGA,UAAA,IAAA,EAAA;AAHA,SAAA,EAIA,IAJA,CAIA,YAAA;AACA,UAAA,KAAA,CAAA,QAAA,CAAA;AACA,YAAA,IAAA,EAAA,SADA;AAEA,YAAA,OAAA,EAAA;AAFA,WAAA;AAIA,SATA,EASA,KATA,CASA,YAAA;AACA,UAAA,KAAA,CAAA,QAAA,CAAA;AACA,YAAA,IAAA,EAAA,MADA;AAEA,YAAA,OAAA,EAAA;AAFA,WAAA;AAIA,SAdA;AAeA;;AACA,UAAA,KAAA,IAAA,CAAA,EACA,KAAA,UAAA,GAAA,IAAA;AACA,KAtBA;AAuBA,IAAA,SAvBA,uBAuBA;AACA,WAAA,KAAA,CAAA,OAAA,GAAA,EAAA;AACA,WAAA,KAAA,CAAA,SAAA,GAAA,EAAA;AACA,WAAA,KAAA,CAAA,WAAA,GAAA,EAAA;AACA,WAAA,KAAA,CAAA,QAAA,GAAA,EAAA;AACA,WAAA,OAAA,GAAA,CAAA;AACA,WAAA,IAAA,GAAA,CAAA;AACA,KA9BA;AA+BA,IAAA,MA/BA,oBA+BA;AACA,WAAA,SAAA;;AACA,UAAA,KAAA,UAAA,IAAA,GAAA,EAAA;AACA,aAAA,KAAA,CAAA,OAAA,GAAA,KAAA,eAAA;AACA,OAFA,MAEA,IAAA,KAAA,UAAA,IAAA,GAAA,EAAA;AACA,aAAA,KAAA,CAAA,SAAA,GAAA,KAAA,eAAA;AACA,OAFA,MAEA,IAAA,KAAA,UAAA,IAAA,GAAA,EAAA;AACA,aAAA,KAAA,CAAA,WAAA,GAAA,KAAA,eAAA;AACA,OAFA,MAEA,IAAA,KAAA,UAAA,IAAA,GAAA,EAAA;AACA,aAAA,KAAA,CAAA,QAAA,GAAA,KAAA,eAAA;AACA;;AACA,WAAA,SAAA,GAAA,IAAA;AACA,WAAA,YAAA;AACA,KA5CA;AA6CA;AACA;AACA;AACA;AACA,IAAA,KAjDA,mBAiDA,CAAA,CAjDA;AAkDA,IAAA,eAlDA,2BAkDA,MAlDA,EAkDA;AACA,aAAA,MAAA,CAAA,OAAA,CAAA,MAAA,CAAA,SAAA,CAAA,CAAA,EAAA,CAAA,CAAA,EAAA,MAAA,CAAA;AACA,KApDA;AAqDA,IAAA,UArDA,sBAqDA,IArDA,EAqDA;AACA,aAAA,KAAA,SAAA,CAAA,IAAA,CAAA,KAAA,GAAA,CAAA,CAAA;AACA,KAvDA;AAwDA,IAAA,YAxDA,wBAwDA,IAxDA,EAwDA;AAAA;;AACA,UAAA,IAAA,CAAA,KAAA,KAAA,CAAA,EAAA;AACA;AACA;;AACA,WAAA,QAAA,CAAA,UAAA,EAAA,IAAA,EAAA;AACA,QAAA,yBAAA,EAAA,IADA;AAEA,QAAA,IAAA,EAAA,SAFA;AAGA,QAAA,iBAAA,EAAA,IAHA;AAIA,QAAA,gBAAA,EAAA;AAJA,OAAA,EAMA,IANA,CAMA,YAAA,CAEA,CARA,EASA,KATA,CASA,UAAA,MAAA,EAAA;AACA,QAAA,MAAA,CAAA,QAAA,CAAA;AACA,UAAA,IAAA,EAAA,MADA;AAEA,UAAA,OAAA,EAAA,MAAA,KAAA,QAAA,GACA,MADA,GAEA;AAJA,SAAA;AAMA,OAhBA;AAiBA,KA7EA;AA8EA;AACA,IAAA,YA/EA,wBA+EA,CA/EA,EA+EA;AACA,WAAA,KAAA,CAAA,KAAA,GAAA,CAAA;AACA,WAAA,SAAA,GAAA,IAAA;AACA,WAAA,YAAA;AAEA,KApFA;AAqFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA,IAAA,YA1GA,0BA0GA;AAAA;;AACA,WAAA,GAAA,CAAA,YAAA,CAAA,KAAA,KAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,GAAA;;AACA,YAAA,GAAA,CAAA,IAAA,IAAA,KAAA,EAAA;AACA,UAAA,MAAA,CAAA,SAAA,GAAA,KAAA;;AACA,UAAA,MAAA,CAAA,QAAA,CAAA,OAAA,CAAA,UAAA;;AACA,UAAA,MAAA,CAAA,SAAA,GAAA,GAAA,CAAA,IAAA,CAAA,IAAA;AACA,UAAA,MAAA,CAAA,SAAA,GAAA,GAAA,CAAA,IAAA,CAAA,KAAA,CAJA,CAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA,SAjBA,MAiBA;AACA,UAAA,MAAA,CAAA,QAAA,CAAA,KAAA,CAAA,UAAA;AACA;AACA,OAtBA;AAuBA,KAlIA;AAmIA;AACA,IAAA,gBApIA,4BAoIA,GApIA,EAoIA,CApIA,EAoIA;AACA,WAAA,IAAA,CAAA,KAAA,KAAA,EAAA,SAAA,EAAA,GAAA;AACA,WAAA,YAAA;AAEA,KAxIA;AAyIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAA,eAjKA,2BAiKA,CAjKA,EAiKA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,CAAA;AACA,KAnKA;AAoKA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA,IAAA,aA7KA,yBA6KA,CA7KA,EA6KA,CAEA,CA/KA;AAgLA,IAAA,eAhLA,2BAgLA,CAhLA,EAgLA;AAAA;;AAAA,UAAA,OAAA,uEAAA,KAAA,KAAA,CAAA,SAAA;AACA,WAAA,SAAA,GAAA,IAAA;AACA,UAAA,IAAA,GAAA,CAAA,eAAA,EAAA,OAAA,EAAA,YAAA,EAAA,WAAA,EAAA,SAAA,EAAA,WAAA,CAAA;AACA,UAAA,IAAA,GAAA,IAAA;AACA,WAAA,KAAA,CAAA,SAAA,GAAA,CAAA;;AACA,UAAA,KAAA,eAAA,EAAA;AACA,aAAA,QAAA,GAAA,WAAA;AACA,QAAA,GAAA,CAAA,oBAAA,CAAA;AACA,UAAA,QAAA,EAAA,IAAA,CAAA,KAAA,UAAA,CAAA,IAAA,eADA;AAEA,UAAA,SAAA,EAAA,KAAA,eAFA;AAGA,UAAA,OAAA,EAAA,OAHA;AAIA,UAAA,QAAA,EAAA,IAAA,CAAA,KAAA,CAAA;AAJA,SAAA,EAKA,IALA,CAKA,UAAA,GAAA,EAAA;AACA,UAAA,MAAA,CAAA,SAAA,GAAA,GAAA,CAAA,IAAA,CAAA,MAAA;AACA,UAAA,MAAA,CAAA,SAAA,GAAA,GAAA,CAAA,IAAA,CAAA,KAAA;AACA,UAAA,MAAA,CAAA,SAAA,GAAA,KAAA;AACA,SATA;AAWA,OAbA,MAaA;AACA,aAAA,QAAA,GAAA,QAAA;AACA,aAAA,QAAA,CAAA,KAAA,CAAA,SAAA;AACA,aAAA,KAAA,CAAA,SAAA,GAAA,CAAA;AACA,aAAA,YAAA;AACA,aAAA,SAAA,GAAA,KAAA;AACA;;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,KAAA,QAAA;AAEA,KA3MA;AA4MA;AACA,IAAA,MA7MA,kBA6MA,GA7MA,EA6MA;AACA,UAAA,GAAA,GAAA,EAAA;AACA,UAAA,OAAA,GAAA,GAAA,CAAA,MAAA,CAAA,UAAA,IAAA,EAAA,OAAA,EAAA;AACA,YAAA,CAAA,IAAA,CAAA,IAAA,CAAA,UAAA,EAAA;AAAA,iBAAA,EAAA,CAAA,eAAA,IAAA,OAAA,CAAA,eAAA;AAAA,SAAA,CAAA,EAAA;AACA,UAAA,IAAA,CAAA,IAAA,CAAA,OAAA;AACA;;AACA,eAAA,IAAA;AACA,OALA,EAKA,EALA,CAAA;AAMA,aAAA,OAAA;AACA,KAtNA,CAuNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AA9OA;AAvDA,CAAA","sourcesContent":["/**\n* @Description: 订单显示\n* @Author: TankNee\n* @Date: 2/24/2020 7:45 PM\n**/\n<template>\n    <div>\n        <div class=\"crumbs\">\n            <el-breadcrumb>\n                <el-breadcrumb-item>\n                    <i class=\"el-icon-files\"></i> 订单管理\n                </el-breadcrumb-item>\n            </el-breadcrumb>\n        </div>\n        <div class=\"container\">\n            <div class=\"handle-box\">\n                <el-select v-model=\"show_state\" placeholder=\"显示全部\" class=\"handle-select mr10\" @change=\"getShowState\">\n                    <el-option key=\"\" label=\"显示全部\" value=\"\"></el-option>\n                    <el-option key=\"1\" label=\"待付款\" value=\"1\"></el-option>\n                    <el-option key=\"2\" label=\"待接单\" value=\"2\"></el-option>\n                    <el-option key=\"3\" label=\"待出行\" value=\"3\"></el-option>\n                    <el-option key=\"4\" label=\"已完成\" value=\"4\"></el-option>\n                    <el-option key=\"5\" label=\"退款申请\" value=\"5\"></el-option>\n                    <el-option key=\"6\" label=\"取消退款申请\" value=\"6\"></el-option>\n                </el-select>\n                <el-input style=\"margin-left: 30px\" placeholder=\"请输入内容\" v-model=\"search_key_word\"\n                          class=\"input-with-select\" clearable>\n                    <el-select style=\"width: 110px;\" v-model=\"searchType\" slot=\"prepend\"\n                               placeholder=\"选择类型\" @change=\"getSearchType\">\n                        <!-- <el-option label=\"下单用户\" value=\"0\"></el-option>\n                        <el-option label=\"产品名称\" value=\"1\"></el-option>\n                        <el-option label=\"下单时间\" value=\"2\"></el-option>\n                        <el-option label=\"处理时间\" value=\"3\"></el-option>\n                        <el-option label=\"联系人\" value=\"4\"></el-option>\n                        <el-option label=\"出行人\" value=\"5\"></el-option> -->\n                        <el-option label=\"订单编号\" value=\"0\"></el-option>\n                        <el-option label=\"产品名称\"  value=\"1\"></el-option>\n                        <el-option label=\"联系人\" value=\"2\"></el-option>\n                        <el-option label=\"下单用户\" value=\"3\"></el-option>\n                    </el-select>\n                    <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"search\"></el-button>\n                </el-input>\n            </div>\n            <div>\n                <el-table\n                        :data=\"tableData\"\n                        v-loading=\"isLoading\"\n                        border\n                        ref=\"multipleTable\"\n                        @select=\"handleSelection\"\n                        @select-all=\"handleSelection\"\n                >\n                    <el-table-column prop=\"id\" label=\"编号\" width=\"80\" align=\"center\"></el-table-column>\n                    <el-table-column prop=\"userName\" label=\"下单用户\" width=\"80\" align=\"center\"></el-table-column>\n                    <el-table-column prop=\"goodsName\" label=\"产品名称\" width=\"240\" align=\"center\"></el-table-column>\n                    <el-table-column prop=\"adultSum\" label=\"成人\" width=\"90\" align=\"center\"></el-table-column>\n                    <el-table-column prop=\"childSum\" label=\"儿童\" width=\"90\" align=\"center\"></el-table-column>\n                    <el-table-column prop=\"contactName\"  label=\"联系人\" width=\"140\" align=\"center\">\n                        <template slot-scope=\"scope\">\n                            <ul>\n                                <li style=\"list-style: none\">\n                                    {{scope.row.contactName}}{{scope.row.contactPhone}}\n                                </li>\n                            </ul>\n                        </template>\n                    </el-table-column>\n                    <!-- <el-table-column label=\"出行人\" width=\"140\" align=\"center\">\n                        <template slot-scope=\"scope\">\n                            <ul>\n                                <li v-for=\"(item, index) in scope.row.passengerList\" :key=\"index\" style=\"list-style: none\">\n                                    {{item.name}}{{item.phone}}\n                                </li>\n                            </ul>\n                        </template>\n                    </el-table-column> -->\n                    <el-table-column prop=\"createTime\" label=\"下单时间\" align=\"center\">\n                        <template slot-scope=\"scope\">\n                            {{new Date(scope.row.createTime).toLocaleString()}}\n                        </template>\n                    </el-table-column>\n                    <el-table-column prop=\"state\" label=\"订单状态\" width=\"150\" align=\"center\">\n                        <template slot-scope=\"scope\">\n                            <el-tag\n                                    :type=\"scope.row.state === 4?'success':'primary'\"\n                                    :style=\"scope.row.state === 4?'cursor: pointer':''\"\n                                    @click=\"handleRefund(scope.row)\"\n                            >{{handleTags(scope.row)}}\n                            </el-tag>\n                        \n                        </template>\n                    </el-table-column>\n                    <!-- <el-table-column type=\"selection\" width=\"60\" align=\"center\"></el-table-column> -->\n                    <!-- <el-table-column prop=\"user_nickname\" label=\"用户名\" width=\"90\" align=\"center\"></el-table-column>\n                    <el-table-column prop=\"title\" label=\"产品名称\" width=\"240\" align=\"center\"></el-table-column>\n                    <el-table-column prop=\"adult_num\" label=\"成人\"  align=\"center\"></el-table-column>\n                    <el-table-column prop=\"child_num\" label=\"儿童\"  align=\"center\"></el-table-column>\n                    <el-table-column prop=\"order_time\" label=\"下单时间\" width=\"150\" align=\"center\">\n                        <template slot-scope=\"scope\">\n                            {{new Date(scope.row.order_time).toLocaleString()}}\n                        </template>\n                    </el-table-column>\n                    <el-table-column prop=\"link_man\" label=\"联系人\" width=\"140\" align=\"center\">\n                        <template slot-scope=\"scope\">\n                            <ul>\n                                <li v-for=\"linkMan in scope.row.link_man\" :key=\"linkMan\" style=\"list-style: none\">\n                                    {{linkMan.name}}\n                                    {{handleSensitive(linkMan.mobile)}}\n                                </li>\n                            </ul>\n                        </template>\n                    </el-table-column>\n                    <el-table-column prop=\"passenger_ids\" label=\"出行人\" width=\"140\" align=\"center\">\n                        <template slot-scope=\"scope\">\n                            <ul>\n                                <li v-for=\"pa in scope.row.passenger\" :key=\"pa\" style=\"list-style: none\">\n                                    {{pa.name}}{{handleSensitive(pa.id_card)}}\n                                </li>\n                            </ul>\n                        </template>\n                    </el-table-column>\n                    <el-table-column prop=\"state\" label=\"订单状态\" width=\"150\" align=\"center\">\n                        <template slot-scope=\"scope\">\n                            <el-tag\n                                    :type=\"scope.row.state === 6?'primary':'success'\"\n                                    :style=\"scope.row.state === 6?'cursor: pointer':''\"\n                                    @click=\"handleRefund(scope.row)\"\n                            >{{handleTags(scope.row)}}\n                            </el-tag>\n                        </template>\n                    </el-table-column> -->\n                    <!-- <el-table-column label=\"操作\" align=\"center\" width=\"160\">\n                        <template slot-scope=\"scope\" >\n                            <el-button type=\"primary\" v-if=\"scope.row.state == 2 || scope.row.state == 1\"\n                            @click=\"handleSub(scope.row)\">{{scope.row.state == 1?'确认退款':scope.row.state == 2?'删除':''}}</el-button>\n                        </template>\n                    </el-table-column> -->\n                </el-table>\n                <!-- <el-dialog title=\"投诉内容\" :visible=\"showRemark\">\n                    XXXXXXXXXXXXXXXXXXX\n                      <div slot=\"footer\" class=\"dialog-footer\">\n                            <el-button >确认撤单</el-button>\n                            <el-button type=\"primary\" @click=\"dialogFormVisible = false\">确 定</el-button>\n                        </div>\n                </el-dialog> -->\n                <div class=\"pagination\">\n                    <el-pagination\n                            background\n                            layout=\"total, prev, pager, next\"\n                            :current-page=\"query.current\"\n                            :page-size=\"query.size\"\n                            :total=\"pageTotal\"\n                            @current-change=\"handlePageChange\"\n                    ></el-pagination>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n<script>\n    import api from '../../utils/api';\n\n    export default {\n        name: 'OrderList',\n        data() {\n            return {\n                userInfo:{},\n                showRemark:false,\n                query: {\n                    //supplierId: '',// 页面初始化时即赋值\n                    orderId: '',\n                    goodsName: '',\n                    contactName: '',\n                    state: '',\n                    userName: '',\n                    current: 1,\n                    size: 6\n                },\n                show_state: '',\n                tableData: [\n                    // {\n                    //     user_nickname: \"TY\",\n                    //     adult_num: 1,\n                    //     child_num: 1,\n                    //     departure_time: \"2020-04-23\",\n                    //     id: 1,\n                    //     link_man: [\n                    //         {   mobile: \"13476818230\",name: \"TY\"    }\n                    //     ],\n                    //     passenger:[\n                    //         {   mobile: \"13476818230\",name: \"TY\"    }\n                    //     ],\n                    //     order_time: \"2020-05-23T01:52:39.000+0000\",\n                    //     state: 3,\n                    //     title: \"三亚春节热售 豪品0自费 印象丽江+洱海大邮轮+玉龙雪山\"\n                    // }\n                ],\n                pageTotal: 0,\n                isLoading: false,\n                // categoryList: [],\n                // categoryIdMap: {},\n                //handleTitle: '',\n                //form: {},\n                searchType: '',\n                search_key_word: '',\n                showType: 'normalData',\n                //cityList: [],\n                stateList: ['待付款', '待接单', '待出行', '已完成', '退款申请', '取消退款申请'],\n            };\n        },\n        created() {\n            // this.pageInit();\n                //this.getTableData();\n                this.userInfo = JSON.parse(localStorage.getItem('userInfo'));\n                //this.query.supplierId = this.userInfo.id\n                this.getOrderList();//获取订单列表\n        },\n        methods: {\n            handleSub(row){\n                var state = row.state\n                if(state == 1){\n                    this.$confirm('是否确认退款', '提示', {\n                        confirmButtonText: '确定',\n                        cancelButtonText: '取消',\n                        type: 'warning'\n                        }).then(() => {\n                        this.$message({\n                            type: 'success',\n                            message: '退款成功!'\n                        });\n                        }).catch(() => {\n                        this.$message({\n                            type: 'info',\n                            message: '已取消退款'\n                        });          \n                    });\n                }\n                if(state == 2)\n                    this.showRemark = true\n            },\n            initQuery() {\n                this.query.orderId = ''\n                this.query.goodsName = ''\n                this.query.contactName = ''\n                this.query.userName = ''\n                this.current = 1\n                this.size = 4\n            },\n            search(){\n                this.initQuery()\n                if(this.searchType == '0') {\n                    this.query.orderId = this.search_key_word\n                }else if(this.searchType == '1') {\n                    this.query.goodsName = this.search_key_word\n                }else if(this.searchType == '2') {\n                    this.query.contactName = this.search_key_word\n                }else if(this.searchType == '3') {\n                    this.query.userName = this.search_key_word\n                }\n                this.isLoading = true\n                this.getOrderList()\n            },\n            // // 正确显示订单状态\n            // handleTags(data) {\n            //     return this.stateList[data.state - 1];\n            // },\n            click(){},\n            handleSensitive(number) {\n                return number.replace(number.substring(3, 7), '****');\n            },\n            handleTags(data) {\n                return this.stateList[data.state - 1];\n            },\n            handleRefund(data) {\n                if (data.state !== 6) {\n                    return;\n                }\n                this.$confirm('是否接受退款申请', '提示', {\n                    distinguishCancelAndClose: true,\n                    type: 'warning',\n                    confirmButtonText: '接受',\n                    cancelButtonText: '拒绝'\n                })\n                    .then(() => {\n\n                    })\n                    .catch(action => {\n                        this.$message({\n                            type: 'info',\n                            message: action === 'cancel'\n                                ? '拒绝退款'\n                                : '关闭页面'\n                        })\n                    });\n            },\n            // 获取改变的状态选择值\n            getShowState(e) {\n                this.query.state = e\n                this.isLoading = true\n                this.getOrderList()\n\n            },\n            // getShowState(e) {\n            //     if (parseInt(e) === 0) {\n            //         this.isLoading = true;\n            //         this.getTableData();\n            //         this.isLoading = false;\n            //     } else {\n            //         api.searchSpecifiedOrder({\n            //             attrName: 'state',\n            //             attrValue: e,\n            //             pageNum: this.query.pageIndex,\n            //             pageSize: this.query.pageSize\n            //         }).then(res => {\n            //             this.tableData = res.data.orders;\n            //             this.pageTotal = res.data.total;\n            //             this.isLoading = false;\n            //         });\n            //     }\n\n            // },\n            \n            // 获取订单列表\n            getOrderList() {\n                this.api.getOrderList(this.query).then( res => {\n                    console.log(res)\n                    if(res.code==\"200\"){\n                        this.isLoading = false\n                        this.$message.success(\"成功获取订单列表\")\n                        this.tableData = res.data.data\n                        this.pageTotal = res.data.total\n                        // if(this.tableData != null) {\n                        //     this.tableData.forEach(item => {\n                        //         this.api.getPassenger({orderId: item.id}).then(response => {\n                        //             if(response.code==\"200\"){\n                        //                 item.passengerList = response.data\n                        //             }else {\n                        //                 this.$message.error(\"获取旅客信息列表失败\")\n                        //             }\n                        //         })\n                        //     })\n                            \n                        // }\n                    }else{\n                        this.$message.error(\"获取订单列表失败\")\n                    }\n                })\n            },\n            // 分页导航点击事件\n            handlePageChange(val, e) {\n                this.$set(this.query, 'current', val);\n                this.getOrderList()\n\n            },\n            // getTableData() {\n            //     this.api.getTableData().then(res => {\n            //     console.log(res)\n            //     if(res.code==\"200\") {\n            //         this.$message.success(\"成功获取订单信息\")\n            //         this.tableData = res.data\n            //     }else{\n            //         this.$message.error(res.message)\n            //     }\n            // })\n            //     // this.isLoading = true;\n            //     // var that = this;\n            //     // api.getOrderList({\n            //     //     pageNum: that.query.pageIndex,\n            //     //     pageSize: that.query.pageSize\n            //     // }).then(res0 => {\n            //     //     this.tableData = res0.data.orders;\n            //     //     this.pageTotal = res0.data.total;\n            //     //     this.isLoading = false;\n            //     //     console.log(this.form);\n            //     // }).catch(err => {\n            //     //     console.log(err);\n            //     // });\n            // },\n            handleSelection(e) {\n                console.log(e);\n            },\n            // handlePageChange(val, e) {\n            //     this.$set(this.query, 'pageIndex', val);\n            //     if (this.showType === 'normalData') {\n            //         this.getOrderList();\n            //     } else {\n            //         this.getSearchResult(e, val);\n            //     }\n\n            // },\n            getSearchType(e) {\n\n            },\n            getSearchResult(e, pageNum = this.query.pageIndex) {\n                this.isLoading = true;\n                var list = ['user_nickname', 'title', 'order_time', 'deal_time', 'linkMan', 'passenger'];\n                var that = this;\n                this.query.pageIndex = 1;\n                if (this.search_key_word) {\n                    this.showType = 'searching';\n                    api.searchSpecifiedOrder({\n                        attrName: list[this.searchType] || 'user_nickname',\n                        attrValue: this.search_key_word,\n                        pageNum: pageNum,\n                        pageSize: that.query.pageSize\n                    }).then(res => {\n                        this.tableData = res.data.orders;\n                        this.pageTotal = res.data.total;\n                        this.isLoading = false;\n                    });\n\n                } else {\n                    this.showType = 'normal';\n                    this.$message.error('请输入搜索内容');\n                    this.query.pageIndex = 1;\n                    this.getOrderList();\n                    this.isLoading = false;\n                }\n                console.log(this.showType);\n\n            },\n            //数组去重\n            uniArr(arr) {\n                var obj = {};\n                var new_arr = arr.reduce(function(prev, element) {\n                    if (!prev.find(el => el.category_con_id == element.category_con_id)) {\n                        prev.push(element);\n                    }\n                    return prev;\n                }, []);\n                return new_arr;\n            },\n            //初始化城市列表\n            // initCity(cityList) {\n            //     var cl = [];\n            //     cityList.forEach(c => {\n            //         var t = {\n            //             value: c.id,\n            //             label: c.city\n            //         };\n            //         cl.push(t);\n            //     });\n            //     return cl;\n            // },\n            // pageInit() {\n            //     api.getAllCities().then(res => {\n            //         if (res.code === 200) {\n            //             this.cityList = this.initCity(res.data);\n            //             localStorage.setItem('cityList', JSON.stringify(this.cityList));\n            //         }\n            //     }).catch(err => {\n            //         console.log(err);\n            //     }).then(res => {\n            //         this.getTableData();\n            //     });\n            // }\n        },\n        \n    };\n</script>\n<style scoped>\n    .handle-box {\n        margin-bottom: 20px;\n        display: flex;\n    }\n\n    .dialog-footer {\n        right: 30px;\n    }\n</style>\n"],"sourceRoot":"src/components/page"}]}