{"remainingRequest":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\babel-loader\\lib\\index.js!D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\QQ下载文件\\BT\\travel_manage\\src\\components\\page\\ConstantList.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\QQ下载文件\\BT\\travel_manage\\src\\components\\page\\ConstantList.vue","mtime":1581329197732},{"path":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport api from \"../../utils/api\";\nexport default {\n  name: 'ConstantList',\n  data: function data() {\n    return {\n      query: {\n        address: '',\n        name: '',\n        pageIndex: 1,\n        pageSize: 10\n      },\n      tableData: [],\n      pageTotal: 10,\n      isLoading: false,\n      categoryList: [],\n      categoryIdMap: {},\n      handleTitle: '',\n      editVisible: false,\n      form: {},\n      ajaxData: {\n        id: 0,\n        category_id: 0,\n        name: '',\n        des: ''\n      },\n      searchType: '',\n      search_key_word: '',\n      showType: 'normalData'\n    };\n  },\n  methods: {\n    getTableData: function getTableData() {\n      var _this = this;\n\n      this.isLoading = true;\n      var that = this;\n      api.getCategoryCons({\n        pageNum: that.query.pageIndex,\n        pageSize: that.query.pageSize\n      }).then(function (res0) {\n        console.log(res0);\n        api.getCategorys().then(function (res1) {\n          console.log(res1);\n          _this.categoryList = res1.data;\n          res1.data.forEach(function (e) {\n            _this.categoryIdMap[e.name] = e.id;\n          });\n          res0.data.categorycons.forEach(function (c) {\n            c['category_name'] = _this.categoryList[c.category_id - 1].name;\n          });\n          _this.tableData = res0.data.categorycons;\n          _this.isLoading = false;\n          _this.pageTotal = res0.data.total;\n        }).catch(function (err) {\n          console.log(err);\n        });\n      }).catch(function (err) {\n        console.log(err);\n      });\n    },\n    handleAdd: function handleAdd() {\n      this.handleTitle = '添加常量';\n      this.editVisible = true;\n      this.form = {};\n    },\n    handleDeleteAllSelection: function handleDeleteAllSelection() {},\n    handleSelection: function handleSelection(e) {\n      console.log(e);\n      this.$confirm(\"\\u786E\\u5B9A\\u8981\\u5220\\u9664\".concat(e.length, \"\\u884C\\u5417\"), '提示', {\n        type: 'warning'\n      }).catch(function (err) {\n        console.log(err);\n      });\n    },\n    handlePageChange: function handlePageChange(val, e) {\n      this.$set(this.query, 'pageIndex', val);\n\n      if (this.showType === 'normalData') {\n        this.getTableData();\n      } else {\n        this.getSearchResult(e, val);\n      }\n    },\n    handleEdit: function handleEdit(index, row) {\n      this.handleTitle = '编辑常量';\n      this.form = row;\n      this.ajaxData.id = row.id;\n      this.ajaxData.category_id = this.form.category_id;\n      this.ajaxData.name = this.form.name;\n      this.ajaxData.des = this.form.des;\n      this.editVisible = true;\n    },\n    handleDelete: function handleDelete(index, row) {\n      var _this2 = this;\n\n      this.$confirm('确定要删除吗', '提示', {\n        type: 'warning'\n      }).then(function () {\n        _this2.isLoading = true;\n\n        _this2.api.deleteCategoryCons({\n          id: row.id\n        }).then(function (res) {\n          _this2.isLoading = false;\n\n          _this2.$message.success(\"\\u5220\\u9664\\u6210\\u529F\");\n\n          _this2.getTableData();\n        });\n      });\n    },\n    handleDialogClose: function handleDialogClose(e) {// this.getTableData();\n    },\n    getCategory_id: function getCategory_id(e) {\n      this.ajaxData.category_id = e;\n      this.form.category_id = e;\n      console.log(this.form.category_id);\n    },\n    getName: function getName(e) {\n      console.log(e);\n      this.ajaxData.name = e;\n      this.form.name = e;\n    },\n    getDes: function getDes(e) {\n      console.log(e);\n      this.ajaxData.des = e;\n      this.form.des = e;\n    },\n    getSearchType: function getSearchType(e) {},\n    getSearchResult: function getSearchResult(e) {\n      var _this3 = this;\n\n      var pageNum = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.query.pageIndex;\n      this.isLoading = true;\n      var list = ['category_id', 'name', 'des'];\n      var that = this;\n      this.query.pageIndex = 1;\n      console.log(this.searchType);\n      console.log(this.search_key_word);\n      console.log(this.categoryList);\n      console.log(this.categoryIdMap[this.search_key_word]);\n\n      if (this.search_key_word) {\n        this.showType = 'searching';\n        console.log(this.categoryIdMap[this.search_key_word]);\n\n        if (this.searchType === '0' && this.categoryIdMap[this.search_key_word] === undefined) {\n          this.$message.error('请输入完整的分类名称');\n          this.query.pageIndex = 1;\n          this.getTableData();\n          this.isLoading = false;\n        } else {\n          var categoryTemp = undefined;\n\n          if (this.searchType === '0') {\n            console.log(this.categoryIdMap);\n            categoryTemp = this.categoryIdMap[this.search_key_word];\n          }\n\n          this.api.searchSpecificCategoryCons({\n            attrName: list[this.searchType] || 'name',\n            attrValue: categoryTemp || this.search_key_word,\n            pageNum: pageNum,\n            pageSize: that.query.pageSize\n          }).then(function (res) {\n            res.data.categorycons.forEach(function (c) {\n              c['category_name'] = _this3.categoryList[c.category_id - 1].name;\n            });\n            _this3.tableData = res.data.categorycons;\n            _this3.isLoading = false;\n            _this3.pageTotal = res.data.total;\n          });\n        }\n      } else {\n        this.showType = 'normal';\n        this.$message.error('请输入搜索内容');\n        this.query.pageIndex = 1;\n        this.getTableData();\n        this.isLoading = false;\n      }\n\n      console.log(this.showType);\n    },\n    saveEdit: function saveEdit() {\n      var _this4 = this;\n\n      if (this.handleTitle === '添加常量') {\n        this.api.addCategoryCons(this.ajaxData).then(function (res) {\n          console.log(res);\n\n          _this4.getTableData();\n\n          _this4.$message.success('添加常量成功');\n        }).catch(function (err) {\n          _this4.$message.error('添加失败');\n        });\n      } else {\n        this.api.updateCategoryCons(this.ajaxData).then(function (res) {\n          console.log(res);\n\n          _this4.getTableData();\n\n          _this4.$message.success('更新常量成功');\n        }).catch(function (err) {\n          _this4.$message.error('更新失败');\n        });\n      }\n\n      this.editVisible = false;\n      console.log(this.ajaxData);\n    },\n    //数组去重\n    uniArr: function uniArr(arr) {\n      var obj = {};\n      var new_arr = arr.reduce(function (prev, element) {\n        if (!prev.find(function (el) {\n          return el.category_con_id == element.category_con_id;\n        })) {\n          prev.push(element);\n        }\n\n        return prev;\n      }, []);\n      return new_arr;\n    }\n  },\n  created: function created() {\n    this.getTableData();\n  }\n};",{"version":3,"sources":["ConstantList.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div>\n        <div class=\"crumbs\">\n            <el-breadcrumb>\n                <el-breadcrumb-item>\n                    <i class=\"el-icon-files\"></i> 常量列表\n                </el-breadcrumb-item>\n            </el-breadcrumb>\n        </div>\n        <div class=\"container\">\n            <div class=\"handle-box\">\n                <el-button\n                        type=\"primary\"\n                        icon=\"el-icon-lx-delete\"\n                        class=\"handle-del mr10\"\n                        @click=\"handleAdd\"\n                >\n                    添加常量\n                </el-button>\n                <el-button\n                        type=\"danger\"\n                        icon=\"el-icon-delete\"\n                        class=\"handle-del mr10\"\n                        @click=\"handleDeleteAllSelection\"\n                >\n                    删除选中项\n                </el-button>\n                <el-input placeholder=\"请输入内容\" v-model=\"search_key_word\" class=\"input-with-select\" clearable>\n                    <el-select style=\"width: 110px;\" v-model=\"searchType\" slot=\"prepend\"\n                               placeholder=\"常量名称\" @change=\"getSearchType\">\n                        <el-option label=\"分类名称\" value=\"0\"></el-option>\n                        <el-option label=\"常量名称\" value=\"1\"></el-option>\n                        <el-option label=\"常量描述\" value=\"2\"></el-option>\n                    </el-select>\n                    <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"getSearchResult\"></el-button>\n                </el-input>\n            </div>\n            <div>\n                <el-table\n                        :data=\"tableData\"\n                        v-loading=\"isLoading\"\n                        border\n                        class=\"table\"\n                        ref=\"multipleTable\"\n                        @select=\"handleSelection\"\n                        @select-all=\"handleSelection\"\n                >\n                    <el-table-column type=\"selection\" width=\"60\" align=\"center\"></el-table-column>\n                    <el-table-column prop=\"category_name\" label=\"分类名称\" width=\"120\" align=\"center\"></el-table-column>\n                    <el-table-column prop=\"name\" label=\"常量名称\" width=\"120\" align=\"center\"></el-table-column>\n                    <el-table-column prop=\"des\" label=\"常量描述\" align=\"left\"></el-table-column>\n                    <el-table-column label=\"操作\" width=\"120\" align=\"center\">\n                        <template slot-scope=\"scope\">\n                            <el-button\n                                    type=\"text\"\n                                    icon=\"el-icon-edit\"\n                                    @click=\"handleEdit(scope.$index, scope.row)\"\n                            >编辑\n                            </el-button>\n                            <el-button\n                                    type=\"text\"\n                                    icon=\"el-icon-delete\"\n                                    class=\"red\"\n                                    @click=\"handleDelete(scope.$index, scope.row)\"\n                            >删除\n                            </el-button>\n                        </template>\n                    </el-table-column>\n                </el-table>\n                <div class=\"pagination\">\n                    <el-pagination\n                            background\n                            layout=\"total, prev, pager, next\"\n                            :current-page=\"query.pageIndex\"\n                            :page-size=\"query.pageSize\"\n                            :total=\"pageTotal\"\n                            @current-change=\"handlePageChange\"\n                    ></el-pagination>\n                </div>\n            </div>\n            <el-dialog width=\"40%\" :title=\"handleTitle\" :visible.sync=\"editVisible\" @close=\"handleDialogClose\">\n                <el-form ref=\"form\" :model=\"form\" label-width=\"70px\">\n                    <el-form-item label=\"分类名称\">\n                        <!--                        <el-input v-model=\"form.category_id\" @change=\"getCategory_id\"></el-input>-->\n                        <el-select v-model=\"form.category_id\" filterable placeholder=\"请选择\" @change=\"getCategory_id\">\n                            <el-option\n                                    v-for=\"item in categoryList\"\n                                    :key=\"item.id\"\n                                    :label=\"item.name\"\n                                    :value=\"item.id\"\n                            >\n                            </el-option>\n                        </el-select>\n                    </el-form-item>\n                    <el-form-item label=\"常量名称\">\n                        <el-input v-model=\"form.name\" @change=\"getName\"></el-input>\n                    </el-form-item>\n                    <el-form-item label=\"常量描述\">\n                        <el-input v-model=\"form.des\" @change=\"getDes\"></el-input>\n                    </el-form-item>\n                </el-form>\n                <div class=\"el-dialog__footer\">\n                    <span class=\"dialog-footer\">\n                    <el-button @click=\"editVisible = false\">取 消</el-button>\n                    <el-button type=\"primary\" @click=\"saveEdit\">确 定</el-button>\n                </span>\n                </div>\n            </el-dialog>\n        </div>\n    </div>\n</template>\n<script>\n    import api from '../../utils/api';\n\n    export default {\n        name: 'ConstantList',\n        data() {\n            return {\n                query: {\n                    address: '',\n                    name: '',\n                    pageIndex: 1,\n                    pageSize: 10\n                },\n                tableData: [],\n                pageTotal: 10,\n                isLoading: false,\n                categoryList: [],\n                categoryIdMap: {},\n                handleTitle: '',\n                editVisible: false,\n                form: {},\n                ajaxData: {\n                    id: 0,\n                    category_id: 0,\n                    name: '',\n                    des: ''\n                },\n                searchType: '',\n                search_key_word: '',\n                showType: 'normalData'\n            };\n        },\n        methods: {\n            getTableData() {\n                this.isLoading = true;\n                var that = this;\n                api.getCategoryCons({\n                    pageNum: that.query.pageIndex,\n                    pageSize: that.query.pageSize\n                }).then(res0 => {\n                    console.log(res0);\n                    api.getCategorys().then(res1 => {\n                        console.log(res1);\n                        this.categoryList = res1.data;\n                        res1.data.forEach(e => {\n                            this.categoryIdMap[e.name] = e.id;\n                        });\n                        res0.data.categorycons.forEach(c => {\n                            c['category_name'] = this.categoryList[c.category_id - 1].name;\n                        });\n                        this.tableData = res0.data.categorycons;\n                        this.isLoading = false;\n                        this.pageTotal = res0.data.total;\n                    }).catch(err => {\n                        console.log(err);\n                    });\n                }).catch(err => {\n                    console.log(err);\n                });\n            },\n            handleAdd() {\n                this.handleTitle = '添加常量';\n                this.editVisible = true;\n                this.form = {};\n            },\n            handleDeleteAllSelection() {\n\n            },\n            handleSelection(e) {\n                console.log(e);\n                this.$confirm(`确定要删除${e.length}行吗`, '提示', {\n                    type: 'warning'\n                }).catch(err => {\n                    console.log(err);\n                });\n            },\n            handlePageChange(val, e) {\n                this.$set(this.query, 'pageIndex', val);\n                if (this.showType === 'normalData') {\n                    this.getTableData();\n                } else {\n                    this.getSearchResult(e, val);\n                }\n\n            },\n            handleEdit(index, row) {\n                this.handleTitle = '编辑常量';\n                this.form = row;\n                this.ajaxData.id = row.id;\n                this.ajaxData.category_id = this.form.category_id;\n                this.ajaxData.name = this.form.name;\n                this.ajaxData.des = this.form.des;\n                this.editVisible = true;\n            },\n            handleDelete(index, row) {\n                this.$confirm('确定要删除吗', '提示', {\n                    type: 'warning'\n                }).then(() => {\n                    this.isLoading = true;\n                    this.api.deleteCategoryCons({\n                        id: row.id\n                    }).then(res => {\n                        this.isLoading = false;\n                        this.$message.success(`删除成功`);\n                        this.getTableData();\n                    });\n                });\n            },\n            handleDialogClose(e) {\n                // this.getTableData();\n            },\n            getCategory_id(e) {\n                this.ajaxData.category_id = e;\n                this.form.category_id = e;\n                console.log(this.form.category_id);\n            },\n            getName(e) {\n                console.log(e);\n                this.ajaxData.name = e;\n                this.form.name = e;\n            },\n            getDes(e) {\n                console.log(e);\n                this.ajaxData.des = e;\n                this.form.des = e;\n            },\n            getSearchType(e) {\n\n            },\n            getSearchResult(e, pageNum = this.query.pageIndex) {\n                this.isLoading = true;\n                var list = ['category_id', 'name', 'des'];\n                var that = this;\n                this.query.pageIndex = 1;\n                console.log(this.searchType);\n                console.log(this.search_key_word);\n                console.log(this.categoryList);\n                console.log(this.categoryIdMap[this.search_key_word]);\n                if (this.search_key_word) {\n                    this.showType = 'searching';\n                    console.log(this.categoryIdMap[this.search_key_word]);\n                    if (this.searchType === '0' && this.categoryIdMap[this.search_key_word] === undefined) {\n                        this.$message.error('请输入完整的分类名称');\n                        this.query.pageIndex = 1;\n                        this.getTableData();\n                        this.isLoading = false;\n                    } else {\n                        var categoryTemp = undefined;\n                        if (this.searchType === '0') {\n                            console.log(this.categoryIdMap);\n                            categoryTemp = this.categoryIdMap[this.search_key_word];\n                        }\n                        this.api.searchSpecificCategoryCons({\n                            attrName: list[this.searchType] || 'name',\n                            attrValue: categoryTemp || this.search_key_word,\n                            pageNum: pageNum,\n                            pageSize: that.query.pageSize\n                        }).then(res => {\n                            res.data.categorycons.forEach(c => {\n                                c['category_name'] = this.categoryList[c.category_id - 1].name;\n                            });\n                            this.tableData = res.data.categorycons;\n                            this.isLoading = false;\n                            this.pageTotal = res.data.total;\n                        });\n                    }\n\n                } else {\n                    this.showType = 'normal';\n                    this.$message.error('请输入搜索内容');\n                    this.query.pageIndex = 1;\n                    this.getTableData();\n                    this.isLoading = false;\n                }\n                console.log(this.showType);\n\n            },\n            saveEdit() {\n                if (this.handleTitle === '添加常量') {\n                    this.api.addCategoryCons(this.ajaxData).then(res => {\n                        console.log(res);\n                        this.getTableData();\n                        this.$message.success('添加常量成功');\n                    }).catch(err => {\n                        this.$message.error('添加失败');\n                    });\n                } else {\n                    this.api.updateCategoryCons(this.ajaxData).then(res => {\n                        console.log(res);\n                        this.getTableData();\n                        this.$message.success('更新常量成功');\n                    }).catch(err => {\n                        this.$message.error('更新失败');\n                    });\n                }\n                this.editVisible = false;\n                console.log(this.ajaxData);\n            },\n            //数组去重\n            uniArr(arr) {\n                var obj = {};\n                var new_arr = arr.reduce(function(prev, element) {\n                    if (!prev.find(el => el.category_con_id == element.category_con_id)) {\n                        prev.push(element);\n                    }\n                    return prev;\n                }, []);\n                return new_arr;\n            }\n        },\n        created() {\n            this.getTableData();\n        }\n    };\n</script>\n<style scoped>\n    .handle-box {\n        margin-bottom: 20px;\n        display: flex;\n    }\n\n    .dialog-footer {\n        right: 30px;\n    }\n\n    .input-with-select {\n        margin-left: 30px;\n    }\n</style>"],"sourceRoot":"src/components/page"}]}