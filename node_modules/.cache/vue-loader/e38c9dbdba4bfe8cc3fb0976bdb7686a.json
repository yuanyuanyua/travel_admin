{"remainingRequest":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\QQ下载文件\\BT\\travel_manage\\src\\components\\page\\TravelNote.vue?vue&type=style&index=0&id=42d0adec&scoped=true&lang=css&","dependencies":[{"path":"D:\\QQ下载文件\\BT\\travel_manage\\src\\components\\page\\TravelNote.vue","mtime":1584277444301},{"path":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.handle-box {\n    margin-bottom: 20px;\n    display: flex;\n}\n\n.dialog-footer {\n    right: 30px;\n}\n\n.input-with-select {\n    margin-left: 30px;\n}\n",{"version":3,"sources":["TravelNote.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsQA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"TravelNote.vue","sourceRoot":"src/components/page","sourcesContent":["/**\n* @Description: 游记列表展示\n* @Author: TankNee\n* @Date: 2/9/2020 11:13 AM\n**/\n\n<template>\n    <div>\n        <div class=\"crumbs\">\n            <el-breadcrumb>\n                <el-breadcrumb-item>\n                    <i class=\"el-icon-files\"></i> 常量列表\n                </el-breadcrumb-item>\n            </el-breadcrumb>\n        </div>\n        <div class=\"container\">\n            <div class=\"handle-box\">\n                <el-button\n                        type=\"danger\"\n                        icon=\"el-icon-delete\"\n                        class=\"handle-del mr10\"\n                        @click=\"handleDeleteAllSelection\"\n                >\n                    删除选中项\n                </el-button>\n                <el-input placeholder=\"请输入内容\" v-model=\"search_key_word\" class=\"input-with-select\" clearable>\n                    <el-select style=\"width: 110px;\" v-model=\"searchType\" slot=\"prepend\"\n                               placeholder=\"作者\" @change=\"getSearchType\">\n                        <el-option label=\"作者\" value=\"0\"></el-option>\n                        <el-option label=\"发表时间\" value=\"1\"></el-option>\n                        <el-option label=\"游记标题\" value=\"2\"></el-option>\n                        <el-option label=\"游记内容\" value=\"3\"></el-option>\n                        <el-option label=\"城市\" value=\"4\"></el-option>\n                    </el-select>\n                    <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"getSearchResult\"></el-button>\n                </el-input>\n            </div>\n            <div>\n                <el-table\n                        :data=\"tableData\"\n                        v-loading=\"isLoading\"\n                        border\n                        class=\"table\"\n                        ref=\"multipleTable\"\n                        @select=\"handleSelection\"\n                        @select-all=\"handleSelection\"\n                >\n                    <el-table-column type=\"selection\" width=\"60\" align=\"center\"></el-table-column>\n                    <el-table-column prop=\"user_nickname\" label=\"作者\" width=\"100\" align=\"center\"></el-table-column>\n                    <el-table-column prop=\"pb_time\" label=\"发表时间\" width=\"100\" align=\"center\"></el-table-column>\n                    <el-table-column prop=\"title\" label=\"游记标题\" width=\"100\" align=\"center\"></el-table-column>\n                    <el-table-column prop=\"city\" label=\"城市\" width=\"100\" align=\"center\"></el-table-column>\n                    <el-table-column prop=\"view_num\" label=\"浏览次数\" width=\"100\" align=\"center\"></el-table-column>\n                    <el-table-column prop=\"des\" label=\"游记内容\" align=\"center\"></el-table-column>\n                    <el-table-column label=\"游记图片\" width=\"240\" align=\"center\">\n                    <template slot-scope=\"scope\">\n                        <el-carousel :interval=\"4000\" type=\"card\" height=\"70px\" indicator-position=\"none\">\n                            <el-carousel-item v-for=\"(img,i) in scope.row.imgUrls\" :key=\"i\">\n                                <el-image\n                                        style=\"width: 120px; height: 70px\"\n                                        class=\"table-td-thumb\"\n                                        :src=\"img\"\n                                ></el-image>\n                            </el-carousel-item>\n                        </el-carousel>\n                    </template>\n                </el-table-column>\n                    <el-table-column label=\"操作\" width=\"100\" align=\"center\">\n                        <template slot-scope=\"scope\">\n                            <el-button\n                                    type=\"text\"\n                                    icon=\"el-icon-delete\"\n                                    class=\"red\"\n                                    @click=\"handleDelete(scope.$index, scope.row)\"\n                            >删除\n                            </el-button>\n                        </template>\n                    </el-table-column>\n                </el-table>\n                <div class=\"pagination\">\n                    <el-pagination\n                            background\n                            layout=\"total, prev, pager, next\"\n                            :current-page=\"query.pageIndex\"\n                            :page-size=\"query.pageSize\"\n                            :total=\"pageTotal\"\n                            @current-change=\"handlePageChange\"\n                    ></el-pagination>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n<script>\n    import api from '../../utils/api';\n\n    export default {\n        name: 'ConstantList',\n        data() {\n            return {\n                query: {\n                    address: '',\n                    name: '',\n                    pageIndex: 1,\n                    pageSize: 10\n                },\n                tableData: [],\n                pageTotal: 10,\n                isLoading: false,\n                categoryList: [],\n                categoryIdMap: {},\n                handleTitle: '',\n                form: {},\n                ajaxData: {\n                    id: 0,\n                    category_id: 0,\n                    name: '',\n                    des: ''\n                },\n                searchType: '',\n                search_key_word: '',\n                showType: 'normalData',\n                cityList: []\n            };\n        },\n        methods: {\n            getTableData() {\n                this.isLoading = true;\n                var that = this;\n                api.getTravelNotes({\n                    pageNum: that.query.pageIndex,\n                    pageSize: that.query.pageSize\n                }).then(res0 => {\n                    console.log(this.cityList);\n                    res0.data.travelnotes.forEach(t => {\n                        console.log(t);\n                        t.city = this.cityList[t.city_id - 1].label;\n                        t.user_nickname = res0.data.users[t.uid];\n                        t.imgUrls = t.imgUrls.map(i=>{\n                            return that.base_api_url+i\n                        })\n                    });\n                    console.log(res0.data.travelnotes);\n                    this.tableData = res0.data.travelnotes;\n                    this.pageTotal = res0.data.total;\n                    this.isLoading = false;\n                    console.log(this.form);\n                }).catch(err => {\n                    console.log(err);\n                });\n            },\n            handleDeleteAllSelection() {\n\n            },\n            handleSelection(e) {\n                console.log(e);\n                // this.$confirm(`确定要删除${e.length}行吗`, '提示', {\n                //     type: 'warning'\n                // }).catch(err => {\n                //     console.log(err);\n                // });\n            },\n            handlePageChange(val, e) {\n                this.$set(this.query, 'pageIndex', val);\n                if (this.showType === 'normalData') {\n                    this.getTableData();\n                } else {\n                    this.getSearchResult(e, val);\n                }\n\n            },\n            handleDelete(index, row) {\n                this.$confirm('确定要删除吗', '提示', {\n                    type: 'warning'\n                }).then(() => {\n                    this.isLoading = true;\n                    this.api.deleteTravelNote({\n                        id: row.id\n                    }).then(res => {\n                        this.isLoading = false;\n                        this.$message.success(`删除成功`);\n                        this.getTableData();\n                    });\n                });\n            },\n            getSearchType(e) {\n\n            },\n            getSearchResult(e, pageNum = this.query.pageIndex) {\n                this.isLoading = true;\n                var list = ['user_nickname', 'pb_time', 'title', 'des', 'city'];\n                var that = this;\n                this.query.pageIndex = 1;\n                if (this.search_key_word) {\n                    this.showType = 'searching';\n                    api.searchSpecificTravelNote({\n                        attrName: list[this.searchType] || 'user_nickname',\n                        attrValue: this.search_key_word,\n                        pageNum: pageNum,\n                        pageSize: that.query.pageSize\n                    }).then(res => {\n                        res.data.travelnotes.forEach(t => {\n                            t.city = this.cityList[t.city_id - 1].label;\n                            t.user_nickname = res.data.users[t.uid];\n                        });\n                        this.tableData = res.data.travelnotes;\n                        this.pageTotal = res.data.total;\n                        this.isLoading = false;\n                    });\n\n                } else {\n                    this.showType = 'normal';\n                    this.$message.error('请输入搜索内容');\n                    this.query.pageIndex = 1;\n                    this.getTableData();\n                    this.isLoading = false;\n                }\n                console.log(this.showType);\n\n            },\n            //数组去重\n            uniArr(arr) {\n                var obj = {};\n                var new_arr = arr.reduce(function(prev, element) {\n                    if (!prev.find(el => el.category_con_id == element.category_con_id)) {\n                        prev.push(element);\n                    }\n                    return prev;\n                }, []);\n                return new_arr;\n            },\n            //初始化城市列表\n            initCity(cityList) {\n                var cl = [];\n                cityList.forEach(c => {\n                    var t = {\n                        value: c.id,\n                        label: c.city\n                    };\n                    cl.push(t);\n                });\n                return cl;\n            },\n            pageInit() {\n                api.getAllCities().then(res => {\n                    if (res.code === 200) {\n                        this.cityList = this.initCity(res.data);\n                        localStorage.setItem('cityList', JSON.stringify(this.cityList));\n                    }\n                }).catch(err => {\n                    console.log(err);\n                }).then(res => {\n                    this.getTableData();\n                });\n            }\n        },\n        created() {\n            this.pageInit();\n        }\n    };\n</script>\n<style scoped>\n    .handle-box {\n        margin-bottom: 20px;\n        display: flex;\n    }\n\n    .dialog-footer {\n        right: 30px;\n    }\n\n    .input-with-select {\n        margin-left: 30px;\n    }\n</style>"]}]}