{"remainingRequest":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\QQ下载文件\\BT\\travel_manage\\src\\components\\page\\TravelProducts.vue?vue&type=style&index=0&id=4391c55e&scoped=true&lang=css&","dependencies":[{"path":"D:\\QQ下载文件\\BT\\travel_manage\\src\\components\\page\\TravelProducts.vue","mtime":1594781098626},{"path":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\QQ下载文件\\BT\\travel_manage\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.el-select .el-input {\n    width: 130px;\n}\n\n.input-with-select .el-input-group__prepend {\n    background-color: #fff;\n}\n\n.el-input-group {\n    width: 40% !important;\n    margin-right: 15px !important;\n}\n\n.el-upload--text {\n    height: 100px !important;\n    width: 100px !important;\n}\n\n.handle-box {\n    margin-bottom: 20px;\n}\n\n.handle-select {\n    width: 120px;\n}\n\n.handle-input {\n    width: 300px;\n    display: inline-block;\n}\n\n.table {\n    width: 100%;\n    font-size: 14px;\n}\n\n.red {\n    color: #ff0000;\n}\n\n.mr10 {\n    margin-right: 10px;\n}\n\n.table-td-thumb {\n    display: block;\n    margin: auto;\n    width: 40px;\n    height: 40px;\n}\n\n.avatar-uploader .el-upload {\n    border: 1px dashed #d9d9d9;\n    border-radius: 6px;\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n}\n\n.avatar-uploader .el-upload:hover {\n    border-color: #409EFF;\n}\n\n.avatar-uploader-icon {\n    font-size: 28px;\n    color: #8c939d;\n    width: 100px;\n    height: 100px;\n    line-height: 100px;\n    /* width: 178px;\n    height: 178px;\n    line-height: 178px; */\n    text-align: center;\n}\n\n.avatar {\n    width: 100px;\n    height: 100px;\n    /* width: 178px;\n    height: 178px; */\n    display: block;\n}\n",{"version":3,"sources":["TravelProducts.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6xBA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TravelProducts.vue","sourceRoot":"src/components/page","sourcesContent":["<template>\r\n    <div>\r\n        <div class=\"crumbs\">\r\n            <el-breadcrumb separator=\"/\">\r\n                <el-breadcrumb-item>\r\n                    <i class=\"el-icon-lx-cascades\"></i> 产品列表\r\n                </el-breadcrumb-item>\r\n            </el-breadcrumb>\r\n        </div>\r\n\r\n        <div class=\"container\">\r\n\r\n            <div class=\"handle-box\">\r\n\r\n\r\n                <el-select v-model=\"show_state\" placeholder=\"显示全部\" class=\"handle-select mr10\" @change=\"getShowState\">\r\n                    <el-option key=\"1\" label=\"显示全部\" value=\"-1\"></el-option>\r\n                    <el-option key=\"2\" label=\"上架中\" value=\"1\"></el-option>\r\n                    <el-option key=\"3\" label=\"已下架\" value=\"0\"></el-option>\r\n                </el-select>\r\n\r\n                <el-input placeholder=\"请输入内容\" v-model=\"search_key_word\" @input=\"get_key\"  class=\"input-with-select\" clearable>\r\n                    <el-select style=\"width: 110px;\" v-model=\"searchType\" slot=\"prepend\" placeholder=\"产品编号\" @change=\"getSearchType\">\r\n                        <el-option label=\"产品编号\" value=\"1\"></el-option>\r\n                        <el-option label=\"产品名称\" value=\"2\"></el-option>\r\n                        <el-option label=\"供应商\" value=\"3\"></el-option>\r\n                    </el-select>\r\n                    <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"getData\"></el-button>\r\n                </el-input>\r\n\r\n\r\n            </div>\r\n            <el-table\r\n                    :data=\"tableData\"\r\n                    v-loading=\"!load_over\"\r\n                    border\r\n                    class=\"table\"\r\n                    ref=\"multipleTable\"\r\n                    header-cell-class-name=\"table-header\"\r\n                    @selection-change=\"handleSelectionChange\"\r\n            >\r\n                <el-table-column type=\"selection\" width=\"60\" align=\"center\"></el-table-column>\r\n                <el-table-column prop=\"pro_number\" label=\"产品编号\" width=\"120\" align=\"center\"></el-table-column>\r\n                <el-table-column prop=\"title\" label=\"产品名称\" width=\"160\" align=\"center\"></el-table-column>\r\n                <el-table-column prop=\"sales_volume\" label=\"销量\" width=\"90\" align=\"center\"></el-table-column>\r\n                <el-table-column prop=\"eva_score\" label=\"评分\" width=\"60\" align=\"center\"></el-table-column>\r\n                <el-table-column label=\"封面图\" width=\"120\" align=\"center\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-image\r\n                                style=\"width: 70px; height: 70px\"\r\n                                class=\"table-td-thumb\"\r\n                                :src=\"scope.row.avatar\"\r\n                                :preview-src-list=\"[scope.row.avatar]\"\r\n                        ></el-image>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column prop=\"provider\" label=\"供应商\" width=\"120\" align=\"center\"></el-table-column>\r\n                <el-table-column label=\"服务保障\" width=\"120\" align=\"center\">\r\n                    <template slot-scope=\"scope\">\r\n                        <div v-for=\"item in scope.row.securityList\" :key=\"item\">{{item}}</div>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column prop=\"trip_days\" label=\"行程天数\" width=\"90\" align=\"center\"></el-table-column>\r\n                <el-table-column label=\"详情图片\" width=\"240\" align=\"center\">\r\n                    <template slot-scope=\"scope\">\r\n                    <el-carousel :interval=\"4000\" type=\"card\" height=\"70px\" indicator-position=\"none\">\r\n                        <el-carousel-item v-for=\"(img,i) in scope.row.imgList\" :key=\"i\">\r\n                            <el-image\r\n                                    style=\"width: 120px; height: 70px\"\r\n                                    class=\"table-td-thumb\"\r\n                                    :src=\"img\"\r\n                            ></el-image>\r\n                        </el-carousel-item>\r\n                    </el-carousel>\r\n                </template>\r\n                </el-table-column>\r\n                <el-table-column label=\"游玩主题\" width=\"120\" align=\"center\">\r\n                    <template slot-scope=\"scope\">\r\n                        <div v-for=\"item in scope.row.themeList\" :key=\"item\">{{item}}</div>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column label=\"交通类型\" width=\"120\" align=\"center\">\r\n                    <template slot-scope=\"scope\">\r\n                        <div v-for=\"item in scope.row.trafficList\" :key=\"item\">{{item}}</div>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column prop=\"address\" width=\"120\" label=\"出发地/目的地\" align=\"center\">\r\n                    <template slot-scope=\"scope\">{{scope.row.start_city}}/{{scope.row.end_city}}</template>\r\n                </el-table-column>\r\n                <el-table-column label=\"价格\" width=\"120\" align=\"center\">\r\n                    <template slot-scope=\"scope\">\r\n                        <div>￥{{scope.row.adult_price}}/成人</div>\r\n                        <div>￥{{scope.row.child_price}}/儿童</div>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column label=\"有效日期\" width=\"120\" align=\"center\">\r\n                    <template slot-scope=\"scope\">\r\n                        {{scope.row.start_time}}\r\n                        <br>\r\n                        至\r\n                        <br>\r\n                        {{scope.row.end_time}}\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column prop=\"status\" width=\"120\" label=\"状态\" align=\"center\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-tag\r\n                                :type=\"scope.row.status?'success':'danger'\"\r\n                        >{{scope.row.status?'上架中':'已下架'}}\r\n                        </el-tag>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column fixed=\"right\" label=\"操作\" width=\"120\" align=\"center\">\r\n                    <template slot-scope=\"scope\">\r\n\r\n                        <el-button\r\n                                :type=\"scope.row.status?'danger':'primary'\"\r\n                                @click=\"handleDelete(scope.$index, scope.row)\"\r\n                        >{{scope.row.status?'强制下架':'上架'}}\r\n                        </el-button>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n            <div class=\"pagination\">\r\n                <el-pagination\r\n                        background\r\n                        layout=\"total, prev, pager, next\"\r\n                        :current-page=\"query.pageIndex\"\r\n                        :page-size=\"query.pageSize\"\r\n                        :total=\"pageTotal\"\r\n                        @current-change=\"handlePageChange\"\r\n                ></el-pagination>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- 编辑弹出框 -->\r\n        <el-dialog :title=\"handleName\" :visible.sync=\"editVisible\" width=\"40%\">\r\n            <el-form ref=\"form\" :model=\"form\" label-width=\"70px\">\r\n                <el-form-item label=\"产品编号\">\r\n                    <el-input v-model=\"form.pro_number\" @change=\"getProNumber\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"产品名称\">\r\n                    <el-input v-model=\"form.title\" @change=\"getProTitle\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"供应商\">\r\n                    <el-input v-model=\"form.provider\" @change=\"getProvider\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"封面图\">\r\n                    <el-upload\r\n                            class=\"avatar-uploader\"\r\n                            :action=\"uploadImgUrl\"\r\n                            :show-file-list=\"false\"\r\n                            :on-success=\"handleAvatarSuccess\"\r\n                            :before-upload=\"beforeAvatarUpload\">\r\n                        <img v-if=\"form.avatar\" :src=\"form.avatar\" class=\"avatar\">\r\n                        <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n                    </el-upload>\r\n                </el-form-item>\r\n                <el-form-item label=\"出发地\">\r\n                    <template>\r\n                        <el-select v-model=\"form.start_city_id\" filterable placeholder=\"请选择\" @change=\"getStartCity\">\r\n                            <el-option\r\n                                    v-for=\"item in travelParams.cityList\"\r\n                                    :key=\"item.value\"\r\n                                    :label=\"item.label\"\r\n                                    :value=\"item.value\">\r\n                            </el-option>\r\n                        </el-select>\r\n                    </template>\r\n                </el-form-item>\r\n                <el-form-item label=\"目的地\">\r\n                    <template>\r\n                        <el-select v-model=\"form.end_city_id\" filterable placeholder=\"请选择\" @change=\"getEndCity\">\r\n                            <el-option\r\n                                    v-for=\"item in travelParams.cityList\"\r\n                                    :key=\"item.value\"\r\n                                    :label=\"item.label\"\r\n                                    :value=\"item.value\">\r\n                            </el-option>\r\n                        </el-select>\r\n                    </template>\r\n                </el-form-item>\r\n                <el-form-item label=\"成人价\">\r\n                    <el-input v-model=\"form.adult_price\" size=\"medium\" @change=\"getAdultPrice\"\r\n                              placeholder=\"\" suffix-icon=\"el-icon-lx-recharge\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"儿童价\">\r\n                    <el-input v-model=\"form.child_price\" suffix-icon=\"el-icon-lx-recharge\"\r\n                              size=\"medium\" @change=\"getChildPrice\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"详情图片\">\r\n                    <el-upload\r\n                            :action=\"uploadImgUrl\"\r\n                            list-type=\"picture-card\"\r\n                            multiple\r\n                            :file-list=\"detailImgList\"\r\n                            :on-success=\"handlePictureSuccess\"\r\n                            :on-preview=\"handlePictureCardPreview\"\r\n                            :on-remove=\"handleRemove\">\r\n                        <i class=\"el-icon-plus\"></i>\r\n                    </el-upload>\r\n                    <el-dialog :visible.sync=\"dialogVisible\">\r\n                        <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\">\r\n                    </el-dialog>\r\n                </el-form-item>\r\n                <el-form-item label=\"服务保障\">\r\n                    <template>\r\n                        <el-checkbox-group v-model=\"securityList\" size=\"small\">\r\n                            <el-checkbox-button v-for=\"(s,i) in travelParams.securityList\" :label=\"s\" :key=\"i\">{{s}}\r\n                            </el-checkbox-button>\r\n                        </el-checkbox-group>\r\n                    </template>\r\n                </el-form-item>\r\n                <el-form-item label=\"产品主题\">\r\n                    <template>\r\n                        <el-checkbox-group v-model=\"themeList\" size=\"small\">\r\n                            <el-checkbox-button v-for=\"(s,i) in travelParams.themeList\" :label=\"s\" :key=\"i\">{{s}}\r\n                            </el-checkbox-button>\r\n                        </el-checkbox-group>\r\n                    </template>\r\n                </el-form-item>\r\n                <el-form-item label=\"交通方式\">\r\n                    <template>\r\n                        <el-checkbox-group v-model=\"trafficList\" size=\"small\">\r\n                            <el-checkbox-button v-for=\"(s,i) in travelParams.trafficList\" :label=\"s\" :key=\"i\">{{s}}\r\n                            </el-checkbox-button>\r\n                        </el-checkbox-group>\r\n                    </template>\r\n                </el-form-item>\r\n                <el-form-item label=\"行程天数\">\r\n                    <template>\r\n                        <el-select v-model=\"form.trip_day_id\" filterable placeholder=\"请选择\" @change=\"getTripDay\">\r\n                            <el-option\r\n                                    v-for=\"item in travelParams.TripList\"\r\n                                    :key=\"item.value\"\r\n                                    :label=\"item.label\"\r\n                                    :value=\"item.value\">\r\n                            </el-option>\r\n                        </el-select>\r\n                    </template>\r\n                </el-form-item>\r\n                <el-form-item label=\"有效日期\">\r\n                    <el-date-picker\r\n                            v-model=\"form.dateArr\"\r\n                            type=\"daterange\"\r\n                            range-separator=\"至\"\r\n                            start-placeholder=\"开始日期\"\r\n                            end-placeholder=\"结束日期\"\r\n                            value-format=\"yyyy-MM-dd\"\r\n                            @change=\"getDate\">\r\n                    </el-date-picker>\r\n                </el-form-item>\r\n                <el-form-item label=\"产品状态\">\r\n                    <el-switch\r\n                            v-model=\"form.status\"\r\n                            active-text=\"上架\"\r\n                            inactive-text=\"下架\"\r\n                            @change=\"getStatus\">\r\n                    </el-switch>\r\n                </el-form-item>\r\n            </el-form>\r\n            <span slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button @click=\"editVisible = false\">取 消</el-button>\r\n                <el-button type=\"primary\" @click=\"saveEdit\">确 定</el-button>\r\n            </span>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        name: 'basetable',\r\n        data() {\r\n            return {\r\n                query: {\r\n                    pro_number: '',\r\n                    provider: '',\r\n                    title:\"\",\r\n                    status:\"\",\r\n                    pageIndex: 1,\r\n                    pageSize: 5\r\n                },\r\n                show_state: '',\r\n                searchType: \"\",\r\n                search_key_word: '',\r\n                tableData: [],\r\n                securityList: ['无购物'],\r\n                themeList: ['古镇水乡'],\r\n                trafficList: ['汽车'],\r\n                ajaxData: {\r\n                    basic: {},\r\n                    paramList: [],\r\n                    imgList: []\r\n                },\r\n                load_over: false,\r\n                handleName: '',\r\n                multipleSelection: [],\r\n                delList: [],\r\n                editVisible: false,\r\n                pageTotal: 0,\r\n                form: {},\r\n                idx: -1,\r\n                id: -1,\r\n                start_city: '',\r\n                end_city: '',\r\n                travelParams: {},\r\n                dialogImageUrl: '',\r\n                dialogVisible: false,\r\n                detailImgList: [],\r\n                uploadImgUrl: '',\r\n                imageUrl: ''\r\n            };\r\n        },\r\n        created() {\r\n            if (JSON.parse(localStorage.getItem('travelParams'))) {\r\n                this.travelParams = JSON.parse(localStorage.getItem('travelParams'));\r\n            } else {\r\n                this.initparams();\r\n            }\r\n            this.getData();\r\n            this.uploadImgUrl = this.base_api_url + 'web/uploadImg';\r\n        },\r\n        methods: {\r\n            getShowState(e) {\r\n                this.query.status = e\r\n                this.getData()\r\n            },\r\n            get_key(e){\r\n                console.log(e)\r\n                this.search_key_word = e\r\n            },\r\n            setKey() {\r\n                this.initQuery()\r\n                var e = this.searchType || 1\r\n                if(e == 1)\r\n                    this.query.pro_number = this.search_key_word\r\n                if(e == 2)\r\n                    this.query.title = this.search_key_word\r\n                if(e == 3)\r\n                    this.query.provider = this.search_key_word\r\n            },\r\n            initQuery(){\r\n                this.query.pro_number = \"\"\r\n                this.query.title = \"\"\r\n                this.query.provider = \"\"\r\n                \r\n            },\r\n            getData() {\r\n                this.setKey()\r\n                var that = this;\r\n                this.load_over = false;\r\n                this.api.getTravelProducts({\r\n                    pro_number:this.query.pro_number,\r\n                    title:this.query.title,\r\n                    provider:this.query.provider,\r\n                    status:this.query.status,\r\n                    pageNum:this.query.pageIndex,\r\n                    pageSize:this.query.pageSize\r\n                }).then(res => {\r\n                    if (res.code == '200') {\r\n                        var data = res.data;\r\n                        var tableData = {\r\n                            list: [],\r\n                            total: data.total\r\n                        };\r\n                        data.list.forEach(d => {\r\n                            d.product.imgList = d.imageList;\r\n                            d.product.paramsList = d.paramsList;\r\n                            tableData.list.push(d.product);\r\n                        });\r\n\r\n                        tableData.list.forEach(v => {\r\n                            v.avatar = that.base_api_url + v.avatar;\r\n                            v.start_city = that.idTocity(v.start_city_id);\r\n                            v.end_city = that.idTocity(v.end_city_id);\r\n                            v.start_time = that.dateFormat(v.start_time, 'yyyy-MM-dd');\r\n                            v.end_time = that.dateFormat(v.end_time, 'yyyy-MM-dd');\r\n                            var arr = [];\r\n                            arr.push(v.start_time);\r\n                            arr.push(v.end_time);\r\n                            v.dateArr = arr;\r\n                            v.trip_day_id = v.trip_days;\r\n                            v.trip_days = v.trip_days + '天' + (v.trip_days - 1) + '晚';\r\n                            v.status = v.status == 1 ? true : false;\r\n                            if (v.imgList.length > 0) {\r\n                                var imgs = [];\r\n                                v.imgList.forEach(img => {\r\n                                    imgs.push(that.base_api_url + img.url);\r\n                                });\r\n                                v.imgList = imgs;\r\n                            }\r\n                            var securityList = [];\r\n                            var themeList = [];\r\n                            var trafficList = [];\r\n                            if (v.paramsList.length > 0) {\r\n                                v.paramsList.forEach(p => {\r\n                                    if (p.category_id === 3)\r\n                                        securityList.push(that.idToName(p.category_con_id, 3));\r\n                                    if (p.category_id === 4)\r\n                                        trafficList.push(that.idToName(p.category_con_id, 4));\r\n                                    if (p.category_id === 5)\r\n                                        themeList.push(that.idToName(p.category_con_id, 5));\r\n                                });\r\n                            }\r\n                            v.securityList = securityList;\r\n                            v.trafficList = trafficList;\r\n                            v.themeList = themeList;\r\n                        });\r\n                        this.tableData = tableData.list;\r\n                        console.log(tableData.list);\r\n                        this.pageTotal = tableData.total || 0;\r\n                        this.load_over = true;\r\n                    }\r\n                });\r\n            },\r\n            //获取产品编号\r\n            getProNumber(e) {\r\n                this.ajaxData.basic.pro_number = e;\r\n            },\r\n            //获取产品名称\r\n            getProTitle(e) {\r\n                this.ajaxData.basic.title = e;\r\n            },\r\n            //获取产品提供商\r\n            getProvider(e) {\r\n                this.ajaxData.basic.provider = e;\r\n            },\r\n            //获取出发地id\r\n            getStartCity(e) {\r\n                this.ajaxData.basic.start_city_id = e;\r\n            },\r\n            //获取目的地id\r\n            getEndCity(e) {\r\n                this.ajaxData.basic.end_city_id = e;\r\n            },\r\n            //获取成人价格\r\n            getAdultPrice(e) {\r\n                this.ajaxData.basic.adult_price = e;\r\n            },\r\n            //获取成人价格\r\n            getChildPrice(e) {\r\n                this.ajaxData.basic.child_price = e;\r\n            },\r\n            //获取产品的服务保障，交通类型，游玩主题等\r\n            getParams() {\r\n                this.ajaxData.paramList = [];\r\n                var arr1 = this.securityList.map(item => {\r\n                    return { category_id: 3, category_con_id: this.idToName(item, 3, true) };\r\n                });\r\n                var arr2 = this.trafficList.map(item => {\r\n                    return { category_id: 4, category_con_id: this.idToName(item, 4, true) };\r\n                });\r\n                var arr3 = this.themeList.map(item => {\r\n                    return { category_id: 5, category_con_id: this.idToName(item, 5, true) };\r\n                });\r\n                this.ajaxData.paramList = this.ajaxData.paramList.concat(arr1, arr2, arr3);\r\n            },\r\n\r\n            //获取行程天数\r\n            getTripDay(e) {\r\n                this.ajaxData.basic.trip_days = this.idToName(e, 6);\r\n            },\r\n            //获取有效日期\r\n            getDate(e) {\r\n                this.ajaxData.basic.start_time = e[0];\r\n                this.ajaxData.basic.end_time = e[1];\r\n            },\r\n            //获取产品状态\r\n            getStatus(e) {\r\n                this.ajaxData.basic.status = e ? 1 : 0;\r\n            },\r\n            handlePictureSuccess(response, file, fileList) {\r\n                this.handleImgList(fileList);\r\n            },\r\n            handleRemove(file, fileList) {\r\n                this.handleImgList(fileList);\r\n            },\r\n            handlePictureCardPreview(file) {\r\n                this.dialogImageUrl = file.url;\r\n                this.dialogVisible = true;\r\n            },\r\n            //图片处理\r\n            handleImgList(fileList) {\r\n                var imgList = [];\r\n                var ajaxImgList = [];\r\n                fileList.forEach(i => {\r\n                    if (i.response.code == '200') {\r\n                        imgList.push(this.base_api_url + i.response.data);\r\n                        ajaxImgList.push({\r\n                            url: i.response.data\r\n                        });\r\n                    }\r\n                });\r\n                this.form.imgList = imgList;\r\n                this.ajaxData.imgList = ajaxImgList;\r\n            },\r\n            //参数处理\r\n            editParam() {\r\n                this.ajaxData.basic.id = this.form.id;\r\n                this.ajaxData.basic.pro_number = this.form.pro_number;\r\n                this.ajaxData.basic.title = this.form.title;\r\n                this.ajaxData.basic.provider = this.form.provider;\r\n                this.ajaxData.basic.avatar = this.form.avatar.replace(this.base_api_url, '');\r\n                this.ajaxData.basic.start_city_id = this.form.start_city_id;\r\n                this.ajaxData.basic.end_city_id = this.form.end_city_id;\r\n                this.ajaxData.basic.start_time = this.form.dateArr[0];\r\n                this.ajaxData.basic.end_time = this.form.dateArr[1];\r\n                this.ajaxData.basic.adult_price = this.form.adult_price;\r\n                this.ajaxData.basic.child_price = this.form.child_price;\r\n                this.ajaxData.basic.trip_days = this.form.trip_day_id > 8 ? this.idToName(this.form.trip_day_id, 6) : this.form.trip_day_id;\r\n                this.ajaxData.basic.status = this.form.status ? 1 : 0;\r\n            },\r\n            //城市id转为名称\r\n            idTocity(city_id) {\r\n                var city_name = '';\r\n                var cityList = JSON.parse(localStorage.getItem('travelParams')).cityList;\r\n                cityList.forEach(c => {\r\n                    if (c.value === city_id)\r\n                        city_name = c.label;\r\n                });\r\n                return city_name;\r\n            },\r\n            //类型转换\r\n            idToName(d, type, reverse = false) {\r\n                var res = '';\r\n                var paramsList = JSON.parse(localStorage.getItem('travelParams'));\r\n                var list = [];\r\n                if (type === 3)\r\n                    list = paramsList.SecurityList;\r\n                if (type === 4)\r\n                    list = paramsList.TrafficList;\r\n                if (type === 5)\r\n                    list = paramsList.ThemeList;\r\n                if (type === 6)\r\n                    list = paramsList.TripList;\r\n\r\n                list.forEach(s => {\r\n                    if (reverse) {\r\n                        if (s.label === d)\r\n                            res = s.value;\r\n                    } else {\r\n                        if (s.value === d)\r\n                            res = s.label;\r\n                    }\r\n\r\n                });\r\n                return res;\r\n\r\n            },\r\n            //初始化常量类型列表\r\n            initparams() {\r\n                var that = this;\r\n                this.api.getCategorys().then(res => {\r\n                    if (res.code == '200') {\r\n                        var categorys = res.data;\r\n                        that.api.getCategoryCons().then(v => {\r\n                            if (v.code == '200') {\r\n                                var categoryCons = v.data;\r\n                                var params = {\r\n                                    cityList: [],\r\n                                    SecurityList: [],\r\n                                    securityList: [],\r\n                                    ThemeList: [],\r\n                                    themeList: [],\r\n                                    TrafficList: [],\r\n                                    trafficList: [],\r\n                                    TripList: [],\r\n                                    tripList: []\r\n                                };\r\n                                categorys.forEach(c => {\r\n                                    categoryCons.forEach(cc => {\r\n                                        var t = {\r\n                                            value: cc.id,\r\n                                            label: cc.name\r\n                                        };\r\n                                        if (c.id === 3 && c.id === cc.category_id) {\r\n                                            params.SecurityList.push(t);\r\n                                            params.securityList.push(cc.name);\r\n                                        }\r\n                                        if (c.id === 4 && c.id === cc.category_id) {\r\n                                            params.TrafficList.push(t);\r\n                                            params.trafficList.push(cc.name);\r\n                                        }\r\n                                        if (c.id === 5 && c.id === cc.category_id) {\r\n                                            params.ThemeList.push(t);\r\n                                            params.themeList.push(cc.name);\r\n                                        }\r\n                                        if (c.id === 6 && c.id === cc.category_id) {\r\n                                            params.TripList.push(t);\r\n                                            params.tripList.push(cc.name);\r\n                                        }\r\n                                    });\r\n                                });\r\n                                that.api.getAllCities().then(city => {\r\n                                    if (res.code == '200') {\r\n                                        params.cityList = that.initCity(city.data);\r\n                                        that.travelParams = params;\r\n                                        localStorage.setItem('travelParams', JSON.stringify(params));\r\n                                    }\r\n\r\n                                });\r\n                            }\r\n\r\n                        });\r\n                    }\r\n                });\r\n\r\n            },\r\n            //初始化城市列表\r\n            initCity(cityList) {\r\n                var cl = [];\r\n                cityList.forEach(c => {\r\n                    var t = {\r\n                        value: c.id,\r\n                        label: c.city\r\n                    };\r\n                    cl.push(t);\r\n                });\r\n                return cl;\r\n            },\r\n            //日期格式转换\r\n            dateFormat(date, fmt) {\r\n                let ret;\r\n                date = new Date(date);\r\n                const opt = {\r\n                    'y+': date.getFullYear().toString(),        // 年\r\n                    'M+': (date.getMonth() + 1).toString(),     // 月\r\n                    'd+': date.getDate().toString()            // 日\r\n                    // 有其他格式化字符需求可以继续添加，必须转化成字符串\r\n                };\r\n                for (let k in opt) {\r\n                    ret = new RegExp('(' + k + ')').exec(fmt);\r\n                    if (ret) {\r\n                        fmt = fmt.replace(ret[1], (ret[1].length == 1) ? (opt[k]) : (opt[k].padStart(ret[1].length, '0')));\r\n                    }\r\n                    ;\r\n                }\r\n                ;\r\n                return fmt;\r\n            },\r\n            //数组去重\r\n            uniArr(arr) {\r\n                var obj = {};\r\n                var new_arr = arr.reduce(function(prev, element) {\r\n                    if (!prev.find(el => el.category_con_id == element.category_con_id)) {\r\n                        prev.push(element);\r\n                    }\r\n                    return prev;\r\n                }, []);\r\n                return new_arr;\r\n            },\r\n            //上传图像成功\r\n            handleAvatarSuccess(res, file) {\r\n                if (res.code == '200') {\r\n                    this.ajaxData.basic.avatar = res.data;\r\n                    this.form.avatar = this.base_api_url + res.data;\r\n                }\r\n                //this.imageUrl = URL.createObjectURL(file.raw);\r\n                //console.log(this.imageUrl)\r\n            },\r\n            //上传图像之前图片类型和大小检验\r\n            beforeAvatarUpload(file) {\r\n                // const isJPG = file.type === 'image/jpeg';\r\n                // const isLt2M = file.size / 1024 / 1024 < 2;\r\n                // if (!isJPG) {\r\n                // this.$message.error('上传头像图片只能是 JPG 格式!');\r\n                // }\r\n                // if (!isLt2M) {\r\n                // this.$message.error('上传头像图片大小不能超过 2MB!');\r\n                // }\r\n                // return isJPG && isLt2M;\r\n                return true;\r\n            },\r\n            // 触发搜索按钮\r\n            handleSearch() {\r\n                this.$set(this.query, 'pageIndex', 1);\r\n                this.getData();\r\n            },\r\n            // 删除操作\r\n            handleDelete(index, row) {\r\n                var that = this;\r\n                // 二次确认删除\r\n                this.$confirm('确定要删除吗？', '提示', {\r\n                    type: 'warning'\r\n                })\r\n                    .then(() => {\r\n                        this.load_over = false;\r\n                        this.api.deleteTP({ id: row.id }).then(res => {\r\n                            if (res.code == '200') {\r\n                                that.$message.success('删除成功');\r\n                                that.tableData.splice(index, 1);\r\n                                that.load_over = true;\r\n                            }\r\n                        });\r\n                    })\r\n                    .catch(() => {\r\n                    });\r\n            },\r\n            // 多选操作\r\n            handleSelectionChange(val) {\r\n                var del_ids = val.map(item=>{\r\n                    return item.id\r\n                })\r\n                this.multipleSelection = del_ids.join(\",\")\r\n                //this.multipleSelection = val;\r\n            },\r\n            delAllSelection() {\r\n                var del_ids = this.multipleSelection\r\n                var that = this;\r\n                // 二次确认删除\r\n                this.$confirm('确定要删除吗？', '提示', {\r\n                    type: 'warning'\r\n                })\r\n                    .then(() => {\r\n                        //this.load_over = false;\r\n                        console.log(del_ids)\r\n                        this.api.deleteTPs({ ids:del_ids }).then(res => {\r\n                            if (res.code == '200') {\r\n                                that.$message.success('删除成功');\r\n                                that.getData()\r\n                                //that.tableData.splice(index, 1);\r\n                                //that.load_over = true;\r\n                            }\r\n                        });\r\n                    })\r\n                    .catch(() => {\r\n                    });\r\n                // const length = this.multipleSelection.length;\r\n                // let str = '';\r\n                // this.delList = this.delList.concat(this.multipleSelection);\r\n                // for (let i = 0; i < length; i++) {\r\n                //     str += this.multipleSelection[i].name + ' ';\r\n                // }\r\n                // this.$message.error(`删除了${str}`);\r\n                this.multipleSelection = \"\";\r\n            },\r\n            //新增\r\n            handleAdd() {\r\n                this.handleName = '添加产品';\r\n                this.form = {};\r\n                this.securityList = [];\r\n                this.trafficList = [];\r\n                this.themeList = [];\r\n                this.detailImgList = [];\r\n                this.editVisible = true;\r\n            },\r\n            // 编辑操作\r\n            handleEdit(index, row) {\r\n                this.handleName = '编辑产品';\r\n                this.idx = index;\r\n                this.form = row;\r\n                this.securityList = row.securityList;\r\n                this.trafficList = row.trafficList;\r\n                this.themeList = row.themeList;\r\n                this.detailImgList = row.imgList.map((t, i) => {\r\n                    return { name: i + '.' + t.split('.')[1], url: t };\r\n                });\r\n                this.editVisible = true;\r\n            },\r\n            // 保存编辑\r\n            saveEdit() {\r\n                var that = this;\r\n                this.editVisible = false;\r\n                this.getParams();\r\n                console.log(this.ajaxData);\r\n                if (this.handleName == '添加产品')\r\n                    this.api.addTP({\r\n                        'product': this.ajaxData.basic,\r\n                        'paramsList': this.ajaxData.paramList,\r\n                        'imageList': this.ajaxData.imgList\r\n                    }).then(res => {\r\n                        that.getData();\r\n                    });\r\n                else {\r\n                    this.editParam();\r\n                    //console.log(this.ajaxData)\r\n                    this.api.updateTP({\r\n                        'product': this.ajaxData.basic,\r\n                        'paramsList': this.ajaxData.paramList,\r\n                        'imageList': this.ajaxData.imgList\r\n                    }).then(res => {\r\n                        that.getData();\r\n                    });\r\n                }\r\n                //this.$message.success(`修改第 ${this.idx + 1} 行成功`);\r\n                //this.$set(this.tableData, this.idx, this.form);\r\n            },\r\n            // 分页导航\r\n            handlePageChange(val) {\r\n                this.$set(this.query, 'pageIndex', val);\r\n                this.getData();\r\n            }\r\n        }\r\n    };\r\n</script>\r\n\r\n<style scoped>\r\n    .el-select .el-input {\r\n        width: 130px;\r\n    }\r\n\r\n    .input-with-select .el-input-group__prepend {\r\n        background-color: #fff;\r\n    }\r\n\r\n    .el-input-group {\r\n        width: 40% !important;\r\n        margin-right: 15px !important;\r\n    }\r\n\r\n    .el-upload--text {\r\n        height: 100px !important;\r\n        width: 100px !important;\r\n    }\r\n\r\n    .handle-box {\r\n        margin-bottom: 20px;\r\n    }\r\n\r\n    .handle-select {\r\n        width: 120px;\r\n    }\r\n\r\n    .handle-input {\r\n        width: 300px;\r\n        display: inline-block;\r\n    }\r\n\r\n    .table {\r\n        width: 100%;\r\n        font-size: 14px;\r\n    }\r\n\r\n    .red {\r\n        color: #ff0000;\r\n    }\r\n\r\n    .mr10 {\r\n        margin-right: 10px;\r\n    }\r\n\r\n    .table-td-thumb {\r\n        display: block;\r\n        margin: auto;\r\n        width: 40px;\r\n        height: 40px;\r\n    }\r\n\r\n    .avatar-uploader .el-upload {\r\n        border: 1px dashed #d9d9d9;\r\n        border-radius: 6px;\r\n        cursor: pointer;\r\n        position: relative;\r\n        overflow: hidden;\r\n    }\r\n\r\n    .avatar-uploader .el-upload:hover {\r\n        border-color: #409EFF;\r\n    }\r\n\r\n    .avatar-uploader-icon {\r\n        font-size: 28px;\r\n        color: #8c939d;\r\n        width: 100px;\r\n        height: 100px;\r\n        line-height: 100px;\r\n        /* width: 178px;\r\n        height: 178px;\r\n        line-height: 178px; */\r\n        text-align: center;\r\n    }\r\n\r\n    .avatar {\r\n        width: 100px;\r\n        height: 100px;\r\n        /* width: 178px;\r\n        height: 178px; */\r\n        display: block;\r\n    }\r\n</style>\r\n"]}]}