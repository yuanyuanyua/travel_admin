(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-707937ec"],{"2af3":function(e,t,a){"use strict";var o=a("3b33"),i=a.n(o);i.a},"3b33":function(e,t,a){},aa2b:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-files"}),e._v(" 常量列表\n            ")])],1)],1),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-lx-delete"},on:{click:e.handleAdd}},[e._v("\n                添加常量\n            ")]),a("el-button",{staticClass:"handle-del mr10",attrs:{type:"danger",icon:"el-icon-delete"},on:{click:e.handleDeleteAllSelection}},[e._v("\n                删除选中项\n            ")]),a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容",clearable:""},model:{value:e.search_key_word,callback:function(t){e.search_key_word=t},expression:"search_key_word"}},[a("el-select",{staticStyle:{width:"110px"},attrs:{slot:"prepend",placeholder:"常量名称"},on:{change:e.getSearchType},slot:"prepend",model:{value:e.searchType,callback:function(t){e.searchType=t},expression:"searchType"}},[a("el-option",{attrs:{label:"分类名称",value:"0"}}),a("el-option",{attrs:{label:"常量名称",value:"1"}}),a("el-option",{attrs:{label:"常量描述",value:"2"}})],1),a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getSearchResult},slot:"append"})],1)],1),a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],ref:"multipleTable",staticClass:"table",attrs:{data:e.tableData,border:""},on:{select:e.handleSelection,"select-all":e.handleSelection}},[a("el-table-column",{attrs:{type:"selection",width:"60",align:"center"}}),a("el-table-column",{attrs:{prop:"category_name",label:"分类名称",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"name",label:"常量名称",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"des",label:"常量描述",align:"left"}}),a("el-table-column",{attrs:{label:"操作",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑\n                        ")]),a("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除\n                        ")])]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.query.pageIndex,"page-size":e.query.pageSize,total:e.pageTotal},on:{"current-change":e.handlePageChange}})],1)],1),a("el-dialog",{attrs:{width:"40%",title:e.handleTitle,visible:e.editVisible},on:{"update:visible":function(t){e.editVisible=t},close:e.handleDialogClose}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px"}},[a("el-form-item",{attrs:{label:"分类名称"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},on:{change:e.getCategory_id},model:{value:e.form.category_id,callback:function(t){e.$set(e.form,"category_id",t)},expression:"form.category_id"}},e._l(e.categoryList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"常量名称"}},[a("el-input",{on:{change:e.getName},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"常量描述"}},[a("el-input",{on:{change:e.getDes},model:{value:e.form.des,callback:function(t){e.$set(e.form,"des",t)},expression:"form.des"}})],1)],1),a("div",{staticClass:"el-dialog__footer"},[a("span",{staticClass:"dialog-footer"},[a("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit}},[e._v("确 定")])],1)])],1)],1)])},i=[],n=(a("7514"),a("7f7f"),a("ac6a"),a("7c15")),s={name:"ConstantList",data:function(){return{query:{address:"",name:"",pageIndex:1,pageSize:10},tableData:[],pageTotal:10,isLoading:!1,categoryList:[],categoryIdMap:{},handleTitle:"",editVisible:!1,form:{},ajaxData:{id:0,category_id:0,name:"",des:""},searchType:"",search_key_word:"",showType:"normalData"}},methods:{getTableData:function(){var e=this;this.isLoading=!0;var t=this;n["a"].getCategoryCons({pageNum:t.query.pageIndex,pageSize:t.query.pageSize}).then((function(t){console.log(t),n["a"].getCategorys().then((function(a){console.log(a),e.categoryList=a.data,a.data.forEach((function(t){e.categoryIdMap[t.name]=t.id})),t.data.categorycons.forEach((function(t){t["category_name"]=e.categoryList[t.category_id-1].name})),e.tableData=t.data.categorycons,e.isLoading=!1,e.pageTotal=t.data.total})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))},handleAdd:function(){this.handleTitle="添加常量",this.editVisible=!0,this.form={}},handleDeleteAllSelection:function(){},handleSelection:function(e){console.log(e),this.$confirm("确定要删除".concat(e.length,"行吗"),"提示",{type:"warning"}).catch((function(e){console.log(e)}))},handlePageChange:function(e,t){this.$set(this.query,"pageIndex",e),"normalData"===this.showType?this.getTableData():this.getSearchResult(t,e)},handleEdit:function(e,t){this.handleTitle="编辑常量",this.form=t,this.ajaxData.id=t.id,this.ajaxData.category_id=this.form.category_id,this.ajaxData.name=this.form.name,this.ajaxData.des=this.form.des,this.editVisible=!0},handleDelete:function(e,t){var a=this;this.$confirm("确定要删除吗","提示",{type:"warning"}).then((function(){a.isLoading=!0,a.api.deleteCategoryCons({id:t.id}).then((function(e){a.isLoading=!1,a.$message.success("删除成功"),a.getTableData()}))}))},handleDialogClose:function(e){},getCategory_id:function(e){this.ajaxData.category_id=e,this.form.category_id=e,console.log(this.form.category_id)},getName:function(e){console.log(e),this.ajaxData.name=e,this.form.name=e},getDes:function(e){console.log(e),this.ajaxData.des=e,this.form.des=e},getSearchType:function(e){},getSearchResult:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.query.pageIndex;this.isLoading=!0;var o=["category_id","name","des"],i=this;if(this.query.pageIndex=1,console.log(this.searchType),console.log(this.search_key_word),console.log(this.categoryList),console.log(this.categoryIdMap[this.search_key_word]),this.search_key_word)if(this.showType="searching",console.log(this.categoryIdMap[this.search_key_word]),"0"===this.searchType&&void 0===this.categoryIdMap[this.search_key_word])this.$message.error("请输入完整的分类名称"),this.query.pageIndex=1,this.getTableData(),this.isLoading=!1;else{var n=void 0;"0"===this.searchType&&(console.log(this.categoryIdMap),n=this.categoryIdMap[this.search_key_word]),this.api.searchSpecificCategoryCons({attrName:o[this.searchType]||"name",attrValue:n||this.search_key_word,pageNum:a,pageSize:i.query.pageSize}).then((function(e){e.data.categorycons.forEach((function(e){e["category_name"]=t.categoryList[e.category_id-1].name})),t.tableData=e.data.categorycons,t.isLoading=!1,t.pageTotal=e.data.total}))}else this.showType="normal",this.$message.error("请输入搜索内容"),this.query.pageIndex=1,this.getTableData(),this.isLoading=!1;console.log(this.showType)},saveEdit:function(){var e=this;"添加常量"===this.handleTitle?this.api.addCategoryCons(this.ajaxData).then((function(t){console.log(t),e.getTableData(),e.$message.success("添加常量成功")})).catch((function(t){e.$message.error("添加失败")})):this.api.updateCategoryCons(this.ajaxData).then((function(t){console.log(t),e.getTableData(),e.$message.success("更新常量成功")})).catch((function(t){e.$message.error("更新失败")})),this.editVisible=!1,console.log(this.ajaxData)},uniArr:function(e){var t=e.reduce((function(e,t){return e.find((function(e){return e.category_con_id==t.category_con_id}))||e.push(t),e}),[]);return t}},created:function(){this.getTableData()}},l=s,c=(a("2af3"),a("2877")),r=Object(c["a"])(l,o,i,!1,null,"5f396743",null);t["default"]=r.exports}}]);