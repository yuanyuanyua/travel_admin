(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5eb4ea16"],{"03c9":function(e,t,a){},"1f61":function(e,t,a){"use strict";var n=a("03c9"),i=a.n(n);i.a},"96bb":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-files"}),e._v(" 常量列表\n            ")])],1)],1),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-button",{staticClass:"handle-del mr10",attrs:{type:"danger",icon:"el-icon-delete"},on:{click:e.handleDeleteAllSelection}},[e._v("\n                删除选中项\n            ")]),a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容",clearable:""},model:{value:e.search_key_word,callback:function(t){e.search_key_word=t},expression:"search_key_word"}},[a("el-select",{staticStyle:{width:"110px"},attrs:{slot:"prepend",placeholder:"作者"},on:{change:e.getSearchType},slot:"prepend",model:{value:e.searchType,callback:function(t){e.searchType=t},expression:"searchType"}},[a("el-option",{attrs:{label:"作者",value:"0"}}),a("el-option",{attrs:{label:"发表时间",value:"1"}}),a("el-option",{attrs:{label:"游记标题",value:"2"}}),a("el-option",{attrs:{label:"游记内容",value:"3"}}),a("el-option",{attrs:{label:"城市",value:"4"}})],1),a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getSearchResult},slot:"append"})],1)],1),a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],ref:"multipleTable",staticClass:"table",attrs:{data:e.tableData,border:""},on:{select:e.handleSelection,"select-all":e.handleSelection}},[a("el-table-column",{attrs:{type:"selection",width:"60",align:"center"}}),a("el-table-column",{attrs:{prop:"user_nickname",label:"作者",width:"100",align:"center"}}),a("el-table-column",{attrs:{prop:"pb_time",label:"发表时间",width:"100",align:"center"}}),a("el-table-column",{attrs:{prop:"title",label:"游记标题",width:"100",align:"center"}}),a("el-table-column",{attrs:{prop:"city",label:"城市",width:"100",align:"center"}}),a("el-table-column",{attrs:{prop:"view_num",label:"浏览次数",width:"100",align:"center"}}),a("el-table-column",{attrs:{prop:"des",label:"游记内容",align:"center"}}),a("el-table-column",{attrs:{label:"游记图片",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-carousel",{attrs:{interval:4e3,type:"card",height:"70px","indicator-position":"none"}},e._l(t.row.imgUrls,(function(e,t){return a("el-carousel-item",{key:t},[a("el-image",{staticClass:"table-td-thumb",staticStyle:{width:"120px",height:"70px"},attrs:{src:e}})],1)})),1)]}}])}),a("el-table-column",{attrs:{label:"操作",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除\n                        ")])]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.query.pageIndex,"page-size":e.query.pageSize,total:e.pageTotal},on:{"current-change":e.handlePageChange}})],1)],1)])])},i=[],l=(a("7514"),a("ac6a"),a("7c15")),s={name:"ConstantList",data:function(){return{query:{address:"",name:"",pageIndex:1,pageSize:10},tableData:[],pageTotal:10,isLoading:!1,categoryList:[],categoryIdMap:{},handleTitle:"",form:{},ajaxData:{id:0,category_id:0,name:"",des:""},searchType:"",search_key_word:"",showType:"normalData",cityList:[]}},methods:{getTableData:function(){var e=this;this.isLoading=!0;var t=this;l["a"].getTravelNotes({pageNum:t.query.pageIndex,pageSize:t.query.pageSize}).then((function(a){console.log(e.cityList),a.data.travelnotes.forEach((function(n){console.log(n),n.city=e.cityList[n.city_id-1].label,n.user_nickname=a.data.users[n.uid],n.imgUrls=n.imgUrls.map((function(e){return t.base_api_url+e}))})),console.log(a.data.travelnotes),e.tableData=a.data.travelnotes,e.pageTotal=a.data.total,e.isLoading=!1,console.log(e.form)})).catch((function(e){console.log(e)}))},handleDeleteAllSelection:function(){},handleSelection:function(e){console.log(e)},handlePageChange:function(e,t){this.$set(this.query,"pageIndex",e),"normalData"===this.showType?this.getTableData():this.getSearchResult(t,e)},handleDelete:function(e,t){var a=this;this.$confirm("确定要删除吗","提示",{type:"warning"}).then((function(){a.isLoading=!0,a.api.deleteTravelNote({id:t.id}).then((function(e){a.isLoading=!1,a.$message.success("删除成功"),a.getTableData()}))}))},getSearchType:function(e){},getSearchResult:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.query.pageIndex;this.isLoading=!0;var n=["user_nickname","pb_time","title","des","city"],i=this;this.query.pageIndex=1,this.search_key_word?(this.showType="searching",l["a"].searchSpecificTravelNote({attrName:n[this.searchType]||"user_nickname",attrValue:this.search_key_word,pageNum:a,pageSize:i.query.pageSize}).then((function(e){e.data.travelnotes.forEach((function(a){a.city=t.cityList[a.city_id-1].label,a.user_nickname=e.data.users[a.uid]})),t.tableData=e.data.travelnotes,t.pageTotal=e.data.total,t.isLoading=!1}))):(this.showType="normal",this.$message.error("请输入搜索内容"),this.query.pageIndex=1,this.getTableData(),this.isLoading=!1),console.log(this.showType)},uniArr:function(e){var t=e.reduce((function(e,t){return e.find((function(e){return e.category_con_id==t.category_con_id}))||e.push(t),e}),[]);return t},initCity:function(e){var t=[];return e.forEach((function(e){var a={value:e.id,label:e.city};t.push(a)})),t},pageInit:function(){var e=this;l["a"].getAllCities().then((function(t){200===t.code&&(e.cityList=e.initCity(t.data),localStorage.setItem("cityList",JSON.stringify(e.cityList)))})).catch((function(e){console.log(e)})).then((function(t){e.getTableData()}))}},created:function(){this.pageInit()}},o=s,c=(a("1f61"),a("2877")),r=Object(c["a"])(o,n,i,!1,null,"5651c434",null);t["default"]=r.exports}}]);